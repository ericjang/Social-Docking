//
// ChemDoodle Web Components 4.4.2
//
// http://web.chemdoodle.com
//
// Copyright 2009 iChemLabs, LLC.  All rights reserved.
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// As a special exception to the GPL, any HTML file in a public website
// or any free web service which merely makes function calls to this
// code, and for that purpose includes it by reference, shall be deemed
// a separate work for copyright law purposes. If you modify this code,
// you may extend this exception to your version of the code, but you
// are not obligated to do so. If you do not wish to do so, delete this
// exception statement from your version.
//
// As an additional exception to the GPL, you may distribute this
// packed form of the code without the copy of the GPL license normally
// required, provided you include this license notice and a URL through
// which recipients can access the corresponding unpacked source code.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// Please contact iChemLabs <http://www.ichemlabs.com/contact> for
// alternate licensing options.
//
var ChemDoodle=function(){var c={};c.structures={};c.iChemLabs={};c.informatics={};c.io={};c.getVersion=function(){return"4.4.2"};return c}();
(function(c,a,k,b,d){a.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1";a.inRelay=false;a.asynchronous=true;a.INFO={userAgent:navigator.userAgent,v_cwc:c.getVersion(),v_jQuery:d.version,v_jQuery_ui:d.ui?d.ui.version:"N/A"};a.contactServer=function(e,l,g,h){if(this.inRelay)alert("Already connecting to the server, please wait for the first request to finish.");else{a.inRelay=true;d.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:e,content:l,info:a.INFO}),url:this.SERVER_URL,
success:function(f){a.inRelay=false;o=JSON.parse(f);o.message&&alert(o.message);g!=null&&o.content&&!o.stop&&g(o.content);o.stop&&h!=null&&h()},error:function(){a.inRelay=false;alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)");h!=null&&h()},beforeSend:function(f){f.withCredentials=true},async:a.asynchronous})}};a.optimize=function(e,l,g,h){this.contactServer("optimize",{mol:k.toJSONDummy(e),dimension:l},function(f){f=k.fromJSONDummy(f.mol);
if(l==2){for(var j=0,n=f.atoms.length;j<n;j++){e.atoms[j].x=f.atoms[j].x;e.atoms[j].y=f.atoms[j].y}g()}else if(l==3){j=0;for(n=f.atoms.length;j<n;j++){f.atoms[j].x/=20;f.atoms[j].y/=20;f.atoms[j].z/=20}g(f)}},h)};a.readSMILES=function(e,l,g){this.contactServer("readSMILES",{smiles:e},function(h){l(k.fromJSONDummy(h.mol))},g)};a.writeSMILES=function(e,l,g){this.contactServer("writeSMILES",{mol:k.toJSONDummy(e)},function(h){l(h.smiles)},g)};a.saveFile=function(e,l,g,h){this.contactServer("saveFile",
{mol:k.toJSONDummy(e),ext:l},function(f){g(f.link)},h)};a.getMoleculeFromDatabase=function(e,l,g,h,f){this.contactServer("getMoleculeFromDatabase",{database:e,dimension:h?h:2,query:l},function(j){if(h==3)for(var n=0,p=j.mol.a.length;n<p;n++){j.mol.a[n].x/=20;j.mol.a[n].y/=-20;j.mol.a[n].z/=20}g(k.fromJSONDummy(j.mol))},f)};a.getMoleculeFromContent=function(e,l,g,h){this.contactServer("getMoleculeFromContent",{content:e,format:l},function(f){for(var j=false,n=0,p=f.mol.a.length;n<p;n++)if(f.mol.a[n].z!=
0){j=true;break}if(j){n=0;for(p=f.mol.a.length;n<p;n++){f.mol.a[n].x/=20;f.mol.a[n].y/=20;f.mol.a[n].z/=20}}g(ChemDoodle.io.fromJSONDummy(f.mol))},h)};a.calculate=function(e,l,g,h){this.contactServer("calculate",{mol:k.toJSONDummy(e),descriptors:l},function(f){g(f)},h)};a.simulate1HNMR=function(e,l,g){this.contactServer("simulateNMR",{mol:k.toJSONDummy(e),nucleus:"H",isotope:1},function(h){l(c.readJCAMP(h.jcamp))},g)};a.simulate13CNMR=function(e,l,g){this.contactServer("simulateNMR",{mol:k.toJSONDummy(e),
nucleus:"C",isotope:13},function(h){l(c.readJCAMP(h.jcamp))},g)};a.simulateMassParentPeak=function(e,l,g){this.contactServer("simulateMassParentPeak",{mol:k.toJSONDummy(e)},function(h){l(c.readJCAMP(h.jcamp))},g)};a.getOptimizedPDBStructure=function(e,l,g,h){this.contactServer("getOptimizedPDBStructure",{id:e,withAtoms:l},function(f){var j=null;j=f.mol?k.fromJSONDummy(f.mol):new b.Molecule;j.chains=k.fromJSONChains(f.ribbons);j.fromJSON=true;g(j)},h)};a.getAd=function(e,l){this.contactServer("getAd",
{},function(g){e(g.image_url,g.target_url)},l)};a.kekulize=function(e,l,g){this.contactServer("kekulize",{mol:k.toJSONDummy(e)},function(h){l(k.fromJSONDummy(h.mol))},g)};a.isGraphIsomorphism=function(e,l,g,h){this.contactServer("isGraphIsomorphism",{arrow:k.toJSONDummy(e),target:k.toJSONDummy(l)},function(f){g(f.value)},h)};a.isSubgraphIsomorphism=function(e,l,g,h){this.contactServer("isSubgraphIsomorphism",{arrow:k.toJSONDummy(e),target:k.toJSONDummy(l)},function(f){g(f.value)},h)};a.readIUPACName=
function(e,l,g){this.contactServer("readIUPACName",{iupac:e},function(h){l(k.fromJSONDummy(h.mol))},g)};a.generateImage=function(e,l,g,h){this.contactServer("generateImage",{mol:k.toJSONDummy(e),ext:l},function(f){g(f.link)},h)};a.getZeoliteFromIZA=function(e,l,g,h,f,j){this.contactServer("getZeoliteFromIZA",{query:e},function(n){l(ChemDoodle.readCIF(n.cif,g,h,f))},j)}})(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery);
ChemDoodle.extensions=function(c,a,k){var b={};b.stringStartsWith=function(d,e){return d.match("^"+e)==e};b.vec3AngleFrom=function(d,e){var l=a.length(d),g=a.length(e);l=a.dot(d,e)/l/g;return k.acos(l)};b.contextHashTo=function(d,e,l,g,h,f,j){var n=0,p=(new c.Point(e,l)).distance(new c.Point(g,h)),q=false,m=e,t=l;e=g-e;for(l=h-l;n<p;){if(q)if(n+j>p){d.moveTo(g,h);break}else{var v=j/p;m+=v*e;t+=v*l;d.moveTo(m,t);n+=j}else if(n+f>p){d.lineTo(g,h);break}else{v=f/p;m+=v*e;t+=v*l;d.lineTo(m,t);n+=f}q=
!q}};b.contextRoundRect=function(d,e,l,g,h,f){d.beginPath();d.moveTo(e+f,l);d.lineTo(e+g-f,l);d.quadraticCurveTo(e+g,l,e+g,l+f);d.lineTo(e+g,l+h-f);d.quadraticCurveTo(e+g,l+h,e+g-f,l+h);d.lineTo(e+f,l+h);d.quadraticCurveTo(e,l+h,e,l+h-f);d.lineTo(e,l+f);d.quadraticCurveTo(e,l,e+f,l);d.closePath()};b.contextEllipse=function(d,e,l,g,h){var f=g/2*0.5522848,j=h/2*0.5522848,n=e+g,p=l+h;g=e+g/2;h=l+h/2;d.beginPath();d.moveTo(e,h);d.bezierCurveTo(e,h-j,g-f,l,g,l);d.bezierCurveTo(g+f,l,n,h-j,n,h);d.bezierCurveTo(n,
h+j,g+f,p,g,p);d.bezierCurveTo(g-f,p,e,h+j,e,h);d.closePath()};return b}(ChemDoodle.structures,vec3,Math);
ChemDoodle.math=function(c,a,k){var b={},d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",
darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",
gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",
lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",
oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",
skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};b.angleBetweenLargest=function(e){if(e.length==0)return 0;if(e.length==1)return e[0]+k.PI;for(var l=0,g=0,h=0,f=e.length-1;h<f;h++){var j=e[h+1]-e[h];if(j>l){l=j;g=(e[h+1]+e[h])/2}}h=e[0]+k.PI*
2-e[e.length-1];if(h>l){g=e[0]-h/2;if(g<0)g+=k.PI*2}return g};b.isBetween=function(e,l,g){return e>=l&&e<=g};b.getRGB=function(e,l){var g=[0,0,0];if(d[e.toLowerCase()]!=null)e=d[e.toLowerCase()];if(e.charAt(0)=="#"){if(e.length==4)e="#"+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)+e.charAt(3)+e.charAt(3);return[parseInt(e.substring(1,3),16)/255*l,parseInt(e.substring(3,5),16)/255*l,parseInt(e.substring(5,7),16)/255*l]}else if(c.stringStartsWith(e,"rgb")){var h=e.replace(/rgb\(|\)/g,"").split(",");
if(h.length!=3)return g;return[parseInt(h[0])/255*l,parseInt(h[1])/255*l,parseInt(h[2])/255*l]}return g};b.distanceFromPointToLineInclusive=function(e,l,g){var h=l.distance(g);g=l.angle(g);g=k.PI/2-g;new a.Point(e.x-l.x,e.y-l.x);new a.Point;g=l.angle(e)+g;e=l.distance(e);pcopRot=new a.Point(e*k.cos(g),-e*k.sin(g));if(b.isBetween(-pcopRot.y,0,h))return k.abs(pcopRot.x);return-1};return b}(ChemDoodle.extensions,ChemDoodle.structures,Math);
ChemDoodle.featureDetection=function(c,a,k,b){var d={};d.supports_canvas=function(){return!!k.createElement("canvas").getContext};d.supports_canvas_text=function(){if(!d.supports_canvas())return false;return typeof k.createElement("canvas").getContext("2d").fillText=="function"};d.supports_webgl=function(){var e=k.createElement("canvas");try{if(e.getContext("webgl"))return true;if(e.getContext("experimental-webgl"))return true}catch(l){}return false};d.supports_xhr2=function(){return a.support.cors};
d.supports_touch=function(){return"ontouchstart"in b};d.supports_gesture=function(){return"ongesturestart"in b};return d}(ChemDoodle.iChemLabs,jQuery,document,window);
ChemDoodle.ELEMENT=function(){function c(k,b,d){this.symbol=k;this.name=b;this.atomicNumber=d;return true}var a=[];a.H=new c("H","Hydrogen",1);a.He=new c("He","Helium",2);a.Li=new c("Li","Lithium",3);a.Be=new c("Be","Beryllium",4);a.B=new c("B","Boron",5);a.C=new c("C","Carbon",6);a.N=new c("N","Nitrogen",7);a.O=new c("O","Oxygen",8);a.F=new c("F","Fluorine",9);a.Ne=new c("Ne","Neon",10);a.Na=new c("Na","Sodium",11);a.Mg=new c("Mg","Magnesium",12);a.Al=new c("Al","Aluminum",13);a.Si=new c("Si","Silicon",
14);a.P=new c("P","Phosphorus",15);a.S=new c("S","Sulfur",16);a.Cl=new c("Cl","Chlorine",17);a.Ar=new c("Ar","Argon",18);a.K=new c("K","Potassium",19);a.Ca=new c("Ca","Calcium",20);a.Sc=new c("Sc","Scandium",21);a.Ti=new c("Ti","Titanium",22);a.V=new c("V","Vanadium",23);a.Cr=new c("Cr","Chromium",24);a.Mn=new c("Mn","Manganese",25);a.Fe=new c("Fe","Iron",26);a.Co=new c("Co","Cobalt",27);a.Ni=new c("Ni","Nickel",28);a.Cu=new c("Cu","Copper",29);a.Zn=new c("Zn","Zinc",30);a.Ga=new c("Ga","Gallium",
31);a.Ge=new c("Ge","Germanium",32);a.As=new c("As","Arsenic",33);a.Se=new c("Se","Selenium",34);a.Br=new c("Br","Bromine",35);a.Kr=new c("Kr","Krypton",36);a.Rb=new c("Rb","Rubidium",37);a.Sr=new c("Sr","Strontium",38);a.Y=new c("Y","Yttrium",39);a.Zr=new c("Zr","Zirconium",40);a.Nb=new c("Nb","Niobium",41);a.Mo=new c("Mo","Molybdenum",42);a.Tc=new c("Tc","Technetium",43);a.Ru=new c("Ru","Ruthenium",44);a.Rh=new c("Rh","Rhodium",45);a.Pd=new c("Pd","Palladium",46);a.Ag=new c("Ag","Silver",47);a.Cd=
new c("Cd","Cadmium",48);a.In=new c("In","Indium",49);a.Sn=new c("Sn","Tin",50);a.Sb=new c("Sb","Antimony",51);a.Te=new c("Te","Tellurium",52);a.I=new c("I","Iodine",53);a.Xe=new c("Xe","Xenon",54);a.Cs=new c("Cs","Cesium",55);a.Ba=new c("Ba","Barium",56);a.La=new c("La","Lanthanum",57);a.Ce=new c("Ce","Cerium",58);a.Pr=new c("Pr","Praseodymium",59);a.Nd=new c("Nd","Neodymium",60);a.Pm=new c("Pm","Promethium",61);a.Sm=new c("Sm","Samarium",62);a.Eu=new c("Eu","Europium",63);a.Gd=new c("Gd","Gadolinium",
64);a.Tb=new c("Tb","Terbium",65);a.Dy=new c("Dy","Dysprosium",66);a.Ho=new c("Ho","Holmium",67);a.Er=new c("Er","Erbium",68);a.Tm=new c("Tm","Thulium",69);a.Yb=new c("Yb","Ytterbium",70);a.Lu=new c("Lu","Lutetium",71);a.Hf=new c("Hf","Hafnium",72);a.Ta=new c("Ta","Tantalum",73);a.W=new c("W","Tungsten",74);a.Re=new c("Re","Rhenium",75);a.Os=new c("Os","Osmium",76);a.Ir=new c("Ir","Iridium",77);a.Pt=new c("Pt","Platinum",78);a.Au=new c("Au","Gold",79);a.Hg=new c("Hg","Mercury",80);a.Tl=new c("Tl",
"Thallium",81);a.Pb=new c("Pb","Lead",82);a.Bi=new c("Bi","Bismuth",83);a.Po=new c("Po","Polonium",84);a.At=new c("At","Astatine",85);a.Rn=new c("Rn","Radon",86);a.Fr=new c("Fr","Francium",87);a.Ra=new c("Ra","Radium",88);a.Ac=new c("Ac","Actinium",89);a.Th=new c("Th","Thorium",90);a.Pa=new c("Pa","Protactinium",91);a.U=new c("U","Uranium",92);a.Np=new c("Np","Neptunium",93);a.Pu=new c("Pu","Plutonium",94);a.Am=new c("Am","Americium",95);a.Cm=new c("Cm","Curium",96);a.Bk=new c("Bk","Berkelium",97);
a.Cf=new c("Cf","Californium",98);a.Es=new c("Es","Einsteinium",99);a.Fm=new c("Fm","Fermium",100);a.Md=new c("Md","Mendelevium",101);a.No=new c("No","Nobelium",102);a.Lr=new c("Lr","Lawrencium",103);a.Rf=new c("Rf","Rutherfordium",104);a.Db=new c("Db","Dubnium",105);a.Sg=new c("Sg","Seaborgium",106);a.Bh=new c("Bh","Bohrium",107);a.Hs=new c("Hs","Hassium",108);a.Mt=new c("Mt","Meitnerium",109);a.Ds=new c("Ds","Darmstadtium",110);a.Rg=new c("Rg","Roentgenium",111);a.Cn=new c("Cn","Copernicium",112);
a.Uut=new c("Uut","Ununtrium",113);a.Uuq=new c("Uuq","Ununquadium",114);a.Uup=new c("Uup","Ununpentium",115);a.Uuh=new c("Uuh","Ununhexium",116);a.Uus=new c("Uus","Ununseptium",117);a.Uuo=new c("Uuo","Ununoctium",118);a.H.jmolColor="#FFFFFF";a.He.jmolColor="#D9FFFF";a.Li.jmolColor="#CC80FF";a.Be.jmolColor="#C2FF00";a.B.jmolColor="#FFB5B5";a.C.jmolColor="#909090";a.N.jmolColor="#3050F8";a.O.jmolColor="#FF0D0D";a.F.jmolColor="#90E050";a.Ne.jmolColor="#B3E3F5";a.Na.jmolColor="#AB5CF2";a.Mg.jmolColor=
"#8AFF00";a.Al.jmolColor="#BFA6A6";a.Si.jmolColor="#F0C8A0";a.P.jmolColor="#FF8000";a.S.jmolColor="#FFFF30";a.Cl.jmolColor="#1FF01F";a.Ar.jmolColor="#80D1E3";a.K.jmolColor="#8F40D4";a.Ca.jmolColor="#3DFF00";a.Sc.jmolColor="#E6E6E6";a.Ti.jmolColor="#BFC2C7";a.V.jmolColor="#A6A6AB";a.Cr.jmolColor="#8A99C7";a.Mn.jmolColor="#9C7AC7";a.Fe.jmolColor="#E06633";a.Co.jmolColor="#F090A0";a.Ni.jmolColor="#50D050";a.Cu.jmolColor="#C88033";a.Zn.jmolColor="#7D80B0";a.Ga.jmolColor="#C28F8F";a.Ge.jmolColor="#668F8F";
a.As.jmolColor="#BD80E3";a.Se.jmolColor="#FFA100";a.Br.jmolColor="#A62929";a.Kr.jmolColor="#5CB8D1";a.Rb.jmolColor="#702EB0";a.Sr.jmolColor="#00FF00";a.Y.jmolColor="#94FFFF";a.Zr.jmolColor="#94E0E0";a.Nb.jmolColor="#73C2C9";a.Mo.jmolColor="#54B5B5";a.Tc.jmolColor="#3B9E9E";a.Ru.jmolColor="#248F8F";a.Rh.jmolColor="#0A7D8C";a.Pd.jmolColor="#006985";a.Ag.jmolColor="#C0C0C0";a.Cd.jmolColor="#FFD98F";a.In.jmolColor="#A67573";a.Sn.jmolColor="#668080";a.Sb.jmolColor="#9E63B5";a.Te.jmolColor="#D47A00";a.I.jmolColor=
"#940094";a.Xe.jmolColor="#429EB0";a.Cs.jmolColor="#57178F";a.Ba.jmolColor="#00C900";a.La.jmolColor="#70D4FF";a.Ce.jmolColor="#FFFFC7";a.Pr.jmolColor="#D9FFC7";a.Nd.jmolColor="#C7FFC7";a.Pm.jmolColor="#A3FFC7";a.Sm.jmolColor="#8FFFC7";a.Eu.jmolColor="#61FFC7";a.Gd.jmolColor="#45FFC7";a.Tb.jmolColor="#30FFC7";a.Dy.jmolColor="#1FFFC7";a.Ho.jmolColor="#00FF9C";a.Er.jmolColor="#00E675";a.Tm.jmolColor="#00D452";a.Yb.jmolColor="#00BF38";a.Lu.jmolColor="#00AB24";a.Hf.jmolColor="#4DC2FF";a.Ta.jmolColor="#4DA6FF";
a.W.jmolColor="#2194D6";a.Re.jmolColor="#267DAB";a.Os.jmolColor="#266696";a.Ir.jmolColor="#175487";a.Pt.jmolColor="#D0D0E0";a.Au.jmolColor="#FFD123";a.Hg.jmolColor="#B8B8D0";a.Tl.jmolColor="#A6544D";a.Pb.jmolColor="#575961";a.Bi.jmolColor="#9E4FB5";a.Po.jmolColor="#AB5C00";a.At.jmolColor="#754F45";a.Rn.jmolColor="#428296";a.Fr.jmolColor="#420066";a.Ra.jmolColor="#007D00";a.Ac.jmolColor="#70ABFA";a.Th.jmolColor="#00BAFF";a.Pa.jmolColor="#00A1FF";a.U.jmolColor="#008FFF";a.Np.jmolColor="#0080FF";a.Pu.jmolColor=
"#006BFF";a.Am.jmolColor="#545CF2";a.Cm.jmolColor="#785CE3";a.Bk.jmolColor="#8A4FE3";a.Cf.jmolColor="#A136D4";a.Es.jmolColor="#B31FD4";a.Fm.jmolColor="#B31FBA";a.Md.jmolColor="#B30DA6";a.No.jmolColor="#BD0D87";a.Lr.jmolColor="#C70066";a.Rf.jmolColor="#CC0059";a.Db.jmolColor="#D1004F";a.Sg.jmolColor="#D90045";a.Bh.jmolColor="#E00038";a.Hs.jmolColor="#E6002E";a.Mt.jmolColor="#EB0026";a.Ds.jmolColor="#000000";a.Rg.jmolColor="#000000";a.Cn.jmolColor="#000000";a.Uut.jmolColor="#000000";a.Uuq.jmolColor=
"#000000";a.Uup.jmolColor="#000000";a.Uuh.jmolColor="#000000";a.Uus.jmolColor="#000000";a.Uuo.jmolColor="#000000";a.H.covalentRadius=0.31;a.He.covalentRadius=0.28;a.Li.covalentRadius=1.28;a.Be.covalentRadius=0.96;a.B.covalentRadius=0.84;a.C.covalentRadius=0.76;a.N.covalentRadius=0.71;a.O.covalentRadius=0.66;a.F.covalentRadius=0.57;a.Ne.covalentRadius=0.58;a.Na.covalentRadius=1.66;a.Mg.covalentRadius=1.41;a.Al.covalentRadius=1.21;a.Si.covalentRadius=1.11;a.P.covalentRadius=1.07;a.S.covalentRadius=
1.05;a.Cl.covalentRadius=1.02;a.Ar.covalentRadius=1.06;a.K.covalentRadius=2.03;a.Ca.covalentRadius=1.76;a.Sc.covalentRadius=1.7;a.Ti.covalentRadius=1.6;a.V.covalentRadius=1.53;a.Cr.covalentRadius=1.39;a.Mn.covalentRadius=1.39;a.Fe.covalentRadius=1.32;a.Co.covalentRadius=1.26;a.Ni.covalentRadius=1.24;a.Cu.covalentRadius=1.32;a.Zn.covalentRadius=1.22;a.Ga.covalentRadius=1.22;a.Ge.covalentRadius=1.2;a.As.covalentRadius=1.19;a.Se.covalentRadius=1.2;a.Br.covalentRadius=1.2;a.Kr.covalentRadius=1.16;a.Rb.covalentRadius=
2.2;a.Sr.covalentRadius=1.95;a.Y.covalentRadius=1.9;a.Zr.covalentRadius=1.75;a.Nb.covalentRadius=1.64;a.Mo.covalentRadius=1.54;a.Tc.covalentRadius=1.47;a.Ru.covalentRadius=1.46;a.Rh.covalentRadius=1.42;a.Pd.covalentRadius=1.39;a.Ag.covalentRadius=1.45;a.Cd.covalentRadius=1.44;a.In.covalentRadius=1.42;a.Sn.covalentRadius=1.39;a.Sb.covalentRadius=1.39;a.Te.covalentRadius=1.38;a.I.covalentRadius=1.39;a.Xe.covalentRadius=1.4;a.Cs.covalentRadius=2.44;a.Ba.covalentRadius=2.15;a.La.covalentRadius=2.07;a.Ce.covalentRadius=
2.04;a.Pr.covalentRadius=2.03;a.Nd.covalentRadius=2.01;a.Pm.covalentRadius=1.99;a.Sm.covalentRadius=1.98;a.Eu.covalentRadius=1.98;a.Gd.covalentRadius=1.96;a.Tb.covalentRadius=1.94;a.Dy.covalentRadius=1.92;a.Ho.covalentRadius=1.92;a.Er.covalentRadius=1.89;a.Tm.covalentRadius=1.9;a.Yb.covalentRadius=1.87;a.Lu.covalentRadius=1.87;a.Hf.covalentRadius=1.75;a.Ta.covalentRadius=1.7;a.W.covalentRadius=1.62;a.Re.covalentRadius=1.51;a.Os.covalentRadius=1.44;a.Ir.covalentRadius=1.41;a.Pt.covalentRadius=1.36;
a.Au.covalentRadius=1.36;a.Hg.covalentRadius=1.32;a.Tl.covalentRadius=1.45;a.Pb.covalentRadius=1.46;a.Bi.covalentRadius=1.48;a.Po.covalentRadius=1.4;a.At.covalentRadius=1.5;a.Rn.covalentRadius=1.5;a.Fr.covalentRadius=2.6;a.Ra.covalentRadius=2.21;a.Ac.covalentRadius=2.15;a.Th.covalentRadius=2.06;a.Pa.covalentRadius=2;a.U.covalentRadius=1.96;a.Np.covalentRadius=1.9;a.Pu.covalentRadius=1.87;a.Am.covalentRadius=1.8;a.Cm.covalentRadius=1.69;a.Bk.covalentRadius=0;a.Cf.covalentRadius=0;a.Es.covalentRadius=
0;a.Fm.covalentRadius=0;a.Md.covalentRadius=0;a.No.covalentRadius=0;a.Lr.covalentRadius=0;a.Rf.covalentRadius=0;a.Db.covalentRadius=0;a.Sg.covalentRadius=0;a.Bh.covalentRadius=0;a.Hs.covalentRadius=0;a.Mt.covalentRadius=0;a.Ds.covalentRadius=0;a.Rg.covalentRadius=0;a.Cn.covalentRadius=0;a.Uut.covalentRadius=0;a.Uuq.covalentRadius=0;a.Uup.covalentRadius=0;a.Uuh.covalentRadius=0;a.Uus.covalentRadius=0;a.Uuo.covalentRadius=0;a.H.vdWRadius=1.2;a.He.vdWRadius=1.4;a.Li.vdWRadius=1.82;a.Be.vdWRadius=0;a.B.vdWRadius=
0;a.C.vdWRadius=1.7;a.N.vdWRadius=1.55;a.O.vdWRadius=1.52;a.F.vdWRadius=1.47;a.Ne.vdWRadius=1.54;a.Na.vdWRadius=2.27;a.Mg.vdWRadius=1.73;a.Al.vdWRadius=0;a.Si.vdWRadius=2.1;a.P.vdWRadius=1.8;a.S.vdWRadius=1.8;a.Cl.vdWRadius=1.75;a.Ar.vdWRadius=1.88;a.K.vdWRadius=2.75;a.Ca.vdWRadius=0;a.Sc.vdWRadius=0;a.Ti.vdWRadius=0;a.V.vdWRadius=0;a.Cr.vdWRadius=0;a.Mn.vdWRadius=0;a.Fe.vdWRadius=0;a.Co.vdWRadius=0;a.Ni.vdWRadius=1.63;a.Cu.vdWRadius=1.4;a.Zn.vdWRadius=1.39;a.Ga.vdWRadius=1.87;a.Ge.vdWRadius=0;a.As.vdWRadius=
1.85;a.Se.vdWRadius=1.9;a.Br.vdWRadius=1.85;a.Kr.vdWRadius=2.02;a.Rb.vdWRadius=0;a.Sr.vdWRadius=0;a.Y.vdWRadius=0;a.Zr.vdWRadius=0;a.Nb.vdWRadius=0;a.Mo.vdWRadius=0;a.Tc.vdWRadius=0;a.Ru.vdWRadius=0;a.Rh.vdWRadius=0;a.Pd.vdWRadius=1.63;a.Ag.vdWRadius=1.72;a.Cd.vdWRadius=1.58;a.In.vdWRadius=1.93;a.Sn.vdWRadius=2.17;a.Sb.vdWRadius=0;a.Te.vdWRadius=2.06;a.I.vdWRadius=1.98;a.Xe.vdWRadius=2.16;a.Cs.vdWRadius=0;a.Ba.vdWRadius=0;a.La.vdWRadius=0;a.Ce.vdWRadius=0;a.Pr.vdWRadius=0;a.Nd.vdWRadius=0;a.Pm.vdWRadius=
0;a.Sm.vdWRadius=0;a.Eu.vdWRadius=0;a.Gd.vdWRadius=0;a.Tb.vdWRadius=0;a.Dy.vdWRadius=0;a.Ho.vdWRadius=0;a.Er.vdWRadius=0;a.Tm.vdWRadius=0;a.Yb.vdWRadius=0;a.Lu.vdWRadius=0;a.Hf.vdWRadius=0;a.Ta.vdWRadius=0;a.W.vdWRadius=0;a.Re.vdWRadius=0;a.Os.vdWRadius=0;a.Ir.vdWRadius=0;a.Pt.vdWRadius=1.75;a.Au.vdWRadius=1.66;a.Hg.vdWRadius=1.55;a.Tl.vdWRadius=1.96;a.Pb.vdWRadius=2.02;a.Bi.vdWRadius=0;a.Po.vdWRadius=0;a.At.vdWRadius=0;a.Rn.vdWRadius=0;a.Fr.vdWRadius=0;a.Ra.vdWRadius=0;a.Ac.vdWRadius=0;a.Th.vdWRadius=
0;a.Pa.vdWRadius=0;a.U.vdWRadius=1.86;a.Np.vdWRadius=0;a.Pu.vdWRadius=0;a.Am.vdWRadius=0;a.Cm.vdWRadius=0;a.Bk.vdWRadius=0;a.Cf.vdWRadius=0;a.Es.vdWRadius=0;a.Fm.vdWRadius=0;a.Md.vdWRadius=0;a.No.vdWRadius=0;a.Lr.vdWRadius=0;a.Rf.vdWRadius=0;a.Db.vdWRadius=0;a.Sg.vdWRadius=0;a.Bh.vdWRadius=0;a.Hs.vdWRadius=0;a.Mt.vdWRadius=0;a.Ds.vdWRadius=0;a.Rg.vdWRadius=0;a.Cn.vdWRadius=0;a.Uut.vdWRadius=0;a.Uuq.vdWRadius=0;a.Uup.vdWRadius=0;a.Uuh.vdWRadius=0;a.Uus.vdWRadius=0;a.Uuo.vdWRadius=0;a.H.valency=1;a.He.valency=
0;a.Li.valency=1;a.Be.valency=2;a.B.valency=3;a.C.valency=4;a.N.valency=3;a.O.valency=2;a.F.valency=1;a.Ne.valency=0;a.Na.valency=1;a.Mg.valency=0;a.Al.valency=0;a.Si.valency=4;a.P.valency=3;a.S.valency=2;a.Cl.valency=1;a.Ar.valency=0;a.K.valency=0;a.Ca.valency=0;a.Sc.valency=0;a.Ti.valency=1;a.V.valency=1;a.Cr.valency=2;a.Mn.valency=3;a.Fe.valency=2;a.Co.valency=1;a.Ni.valency=1;a.Cu.valency=0;a.Zn.valency=0;a.Ga.valency=0;a.Ge.valency=4;a.As.valency=3;a.Se.valency=2;a.Br.valency=1;a.Kr.valency=
0;a.Rb.valency=0;a.Sr.valency=0;a.Y.valency=0;a.Zr.valency=0;a.Nb.valency=1;a.Mo.valency=2;a.Tc.valency=3;a.Ru.valency=2;a.Rh.valency=1;a.Pd.valency=0;a.Ag.valency=0;a.Cd.valency=0;a.In.valency=0;a.Sn.valency=4;a.Sb.valency=3;a.Te.valency=2;a.I.valency=1;a.Xe.valency=0;a.Cs.valency=0;a.Ba.valency=0;a.La.valency=0;a.Ce.valency=0;a.Pr.valency=0;a.Nd.valency=0;a.Pm.valency=0;a.Sm.valency=0;a.Eu.valency=0;a.Gd.valency=0;a.Tb.valency=0;a.Dy.valency=0;a.Ho.valency=0;a.Er.valency=0;a.Tm.valency=0;a.Yb.valency=
0;a.Lu.valency=0;a.Hf.valency=0;a.Ta.valency=1;a.W.valency=2;a.Re.valency=3;a.Os.valency=2;a.Ir.valency=3;a.Pt.valency=0;a.Au.valency=1;a.Hg.valency=0;a.Tl.valency=0;a.Pb.valency=4;a.Bi.valency=3;a.Po.valency=2;a.At.valency=1;a.Rn.valency=0;a.Fr.valency=0;a.Ra.valency=0;a.Ac.valency=0;a.Th.valency=0;a.Pa.valency=0;a.U.valency=0;a.Np.valency=0;a.Pu.valency=0;a.Am.valency=0;a.Cm.valency=0;a.Bk.valency=0;a.Cf.valency=0;a.Es.valency=0;a.Fm.valency=0;a.Md.valency=0;a.No.valency=0;a.Lr.valency=0;a.Rf.valency=
0;a.Db.valency=0;a.Sg.valency=0;a.Bh.valency=0;a.Hs.valency=0;a.Mt.valency=0;a.Ds.valency=0;a.Rg.valency=0;a.Cn.valency=0;a.Uut.valency=0;a.Uuq.valency=0;a.Uup.valency=0;a.Uuh.valency=0;a.Uus.valency=0;a.Uuo.valency=0;a.H.mass=1;a.He.mass=4;a.Li.mass=7;a.Be.mass=9;a.B.mass=11;a.C.mass=12;a.N.mass=14;a.O.mass=16;a.F.mass=19;a.Ne.mass=20;a.Na.mass=23;a.Mg.mass=24;a.Al.mass=27;a.Si.mass=28;a.P.mass=31;a.S.mass=32;a.Cl.mass=35;a.Ar.mass=40;a.K.mass=39;a.Ca.mass=40;a.Sc.mass=45;a.Ti.mass=48;a.V.mass=51;
a.Cr.mass=52;a.Mn.mass=55;a.Fe.mass=56;a.Co.mass=59;a.Ni.mass=58;a.Cu.mass=63;a.Zn.mass=64;a.Ga.mass=69;a.Ge.mass=74;a.As.mass=75;a.Se.mass=80;a.Br.mass=79;a.Kr.mass=84;a.Rb.mass=85;a.Sr.mass=88;a.Y.mass=89;a.Zr.mass=90;a.Nb.mass=93;a.Mo.mass=98;a.Tc.mass=0;a.Ru.mass=102;a.Rh.mass=103;a.Pd.mass=106;a.Ag.mass=107;a.Cd.mass=114;a.In.mass=115;a.Sn.mass=120;a.Sb.mass=121;a.Te.mass=130;a.I.mass=127;a.Xe.mass=132;a.Cs.mass=133;a.Ba.mass=138;a.La.mass=139;a.Ce.mass=140;a.Pr.mass=141;a.Nd.mass=142;a.Pm.mass=
0;a.Sm.mass=152;a.Eu.mass=153;a.Gd.mass=158;a.Tb.mass=159;a.Dy.mass=164;a.Ho.mass=165;a.Er.mass=166;a.Tm.mass=169;a.Yb.mass=174;a.Lu.mass=175;a.Hf.mass=180;a.Ta.mass=181;a.W.mass=184;a.Re.mass=187;a.Os.mass=192;a.Ir.mass=193;a.Pt.mass=195;a.Au.mass=197;a.Hg.mass=202;a.Tl.mass=205;a.Pb.mass=208;a.Bi.mass=209;a.Po.mass=0;a.At.mass=0;a.Rn.mass=0;a.Fr.mass=0;a.Ra.mass=0;a.Ac.mass=0;a.Th.mass=232;a.Pa.mass=231;a.U.mass=238;a.Np.mass=0;a.Pu.mass=0;a.Am.mass=0;a.Cm.mass=0;a.Bk.mass=0;a.Cf.mass=0;a.Es.mass=
0;a.Fm.mass=0;a.Md.mass=0;a.No.mass=0;a.Lr.mass=0;a.Rf.mass=0;a.Db.mass=0;a.Sg.mass=0;a.Bh.mass=0;a.Hs.mass=0;a.Mt.mass=0;a.Ds.mass=0;a.Rg.mass=0;a.Cn.mass=0;a.Uut.mass=0;a.Uuq.mass=0;a.Uup.mass=0;a.Uuh.mass=0;a.Uus.mass=0;a.Uuo.mass=0;return a}();
ChemDoodle.SYMBOLS=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es",
"Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Uut","Uuq","Uup","Uuh","Uus","Uuo"];
ChemDoodle.RESIDUE=function(){function c(k,b){this.symbol=k;this.name=b;return true}var a=[];a.Ala=new c("Ala","Alanine");a.Arg=new c("Arg","Arginine");a.Asn=new c("Asn","Asparagine");a.Asp=new c("Asp","Aspartic Acid");a.Cys=new c("Cys","Cysteine");a.Gln=new c("Gln","Glutamine");a.Glu=new c("Glu","Glutamic Acid");a.Gly=new c("Gly","Glycine");a.His=new c("His","Histidine");a.Ile=new c("Ile","Isoleucine");a.Leu=new c("Leu","Leucine");a.Lys=new c("Lys","Lysine");a.Met=new c("Met","Methionine");a.Phe=
new c("Phe","Phenylalanine");a.Pro=new c("Pro","Proline");a.Ser=new c("Ser","Serine");a.Thr=new c("Thr","Threonine");a.Trp=new c("Trp","Tryptophan");a.Tyr=new c("Tyr","Tyrosine");a.Val=new c("Val","Valine");a.Asx=new c("Asx","Asparagine/Aspartic Acid");a.Glx=new c("Glx","Glutamine/Glutamic Acid");a["*"]=new c("*","Other");a.A=new c("A","Adenine");a.G=new c("G","Guanine");a.I=new c("I","");a.C=new c("C","Cytosine");a.T=new c("T","Thymine");a.U=new c("U","Uracil");a.Ala.aminoColor="#C8C8C8";a.Arg.aminoColor=
"#145AFF";a.Asn.aminoColor="#00DCDC";a.Asp.aminoColor="#E60A0A";a.Cys.aminoColor="#E6E600";a.Gln.aminoColor="#00DCDC";a.Glu.aminoColor="#E60A0A";a.Gly.aminoColor="#EBEBEB";a.His.aminoColor="#8282D2";a.Ile.aminoColor="#0F820F";a.Leu.aminoColor="#0F820F";a.Lys.aminoColor="#145AFF";a.Met.aminoColor="#E6E600";a.Phe.aminoColor="#3232AA";a.Pro.aminoColor="#DC9682";a.Ser.aminoColor="#FA9600";a.Thr.aminoColor="#FA9600";a.Trp.aminoColor="#B45AB4";a.Tyr.aminoColor="#3232AA";a.Val.aminoColor="#0F820F";a.Asx.aminoColor=
"#FF69B4";a.Glx.aminoColor="#FF69B4";a["*"].aminoColor="#BEA06E";a.A.aminoColor="#BEA06E";a.G.aminoColor="#BEA06E";a.I.aminoColor="#BEA06E";a.C.aminoColor="#BEA06E";a.T.aminoColor="#BEA06E";a.U.aminoColor="#BEA06E";a.Ala.shapelyColor="#8CFF8C";a.Arg.shapelyColor="#00007C";a.Asn.shapelyColor="#FF7C70";a.Asp.shapelyColor="#A00042";a.Cys.shapelyColor="#FFFF70";a.Gln.shapelyColor="#FF4C4C";a.Glu.shapelyColor="#660000";a.Gly.shapelyColor="#FFFFFF";a.His.shapelyColor="#7070FF";a.Ile.shapelyColor="#004C00";
a.Leu.shapelyColor="#455E45";a.Lys.shapelyColor="#4747B8";a.Met.shapelyColor="#B8A042";a.Phe.shapelyColor="#534C52";a.Pro.shapelyColor="#525252";a.Ser.shapelyColor="#FF7042";a.Thr.shapelyColor="#B84C00";a.Trp.shapelyColor="#4F4600";a.Tyr.shapelyColor="#8C704C";a.Val.shapelyColor="#FF8CFF";a.Asx.shapelyColor="#FF00FF";a.Glx.shapelyColor="#FF00FF";a["*"].shapelyColor="#FF00FF";a.A.shapelyColor="#A0A0FF";a.G.shapelyColor="#FF7070";a.I.shapelyColor="#80FFFF";a.C.shapelyColor="#FF8C4B";a.T.shapelyColor=
"#A0FFA0";a.U.shapelyColor="#FF8080";return a}();(function(c){c.Queue=function(){var a=[],k=0;this.getSize=function(){return a.length-k};this.isEmpty=function(){return a.length==0};this.enqueue=function(b){a.push(b)};this.dequeue=function(){var b=undefined;if(a.length){b=a[k];if(++k*2>=a.length){a=a.slice(k);k=0}}return b};this.getOldestElement=function(){var b=undefined;if(a.length)b=a[k];return b}}})(ChemDoodle.structures);
(function(c,a){c.Point=function(k,b){this.x=k?k:0;this.y=b?b:0;this.sub=function(d){this.x-=d.x;this.y-=d.y};this.add=function(d){this.x+=d.x;this.y+=d.y};this.distance=function(d){return a.sqrt(a.pow(d.x-this.x,2)+a.pow(d.y-this.y,2))};this.angleForStupidCanvasArcs=function(d){var e=d.x-this.x;d=d.y-this.y;var l=0;for(l=e==0?d==0?0:d>0?a.PI/2:3*a.PI/2:d==0?e>0?0:a.PI:e<0?a.atan(d/e)+a.PI:d<0?a.atan(d/e)+2*a.PI:a.atan(d/e);l<0;)l+=a.PI*2;l%=a.PI*2;return l};this.angle=function(d){var e=d.x-this.x;
d=this.y-d.y;var l=0;for(l=e==0?d==0?0:d>0?a.PI/2:3*a.PI/2:d==0?e>0?0:a.PI:e<0?a.atan(d/e)+a.PI:d<0?a.atan(d/e)+2*a.PI:a.atan(d/e);l<0;)l+=a.PI*2;l%=a.PI*2;return l};return true}})(ChemDoodle.structures,Math);
(function(c,a,k,b,d){k.Atom=function(e,l,g,h){this.x=l?l:0;this.y=g?g:0;this.z=h?h:0;this.charge=0;this.mass=-1;this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0;this.isHidden=false;this.label=e?e.replace(/\s/g,""):"C";if(!c[this.label])this.label="C";this.isSelected=this.isHover=this.isLone=false;this.add3D=function(f){this.x+=f.x;this.y+=f.y;this.z+=f.z};this.sub3D=function(f){this.x-=f.x;this.y-=f.y;this.z-=f.z};this.distance3D=function(f){return b.sqrt(b.pow(f.x-this.x,2)+
b.pow(f.y-this.y,2)+b.pow(f.z-this.z,2))};this.draw=function(f,j){if(this.specs)j=this.specs;var n=j.getFontString(j.atoms_font_size_2D,j.atoms_font_families_2D,j.atoms_font_bold_2D,j.atoms_font_italic_2D);f.font=n;f.fillStyle=j.atoms_color;if(j.atoms_useJMOLColors)f.fillStyle=c[this.label].jmolColor;if(this.isLone||j.atoms_circles_2D){f.beginPath();f.arc(this.x,this.y,j.atoms_circleDiameter_2D/2,0,b.PI*2,false);f.fill();if(j.atoms_circleBorderWidth_2D>0){f.lineWidth=j.atoms_circleBorderWidth_2D;
f.strokeStyle="black";f.stroke(this.x,this.y,0,b.PI*2,j.atoms_circleDiameter_2D/2)}}else if(this.isLabelVisible(j)){f.textAlign="center";f.textBaseline="middle";f.fillText(this.label,this.x,this.y);if(this.mass!=-1){var p=f.measureText(this.label).width,q=j.getFontString(j.atoms_font_size_2D*0.7,j.atoms_font_families_2D,j.atoms_font_bold_2D,j.atoms_font_italic_2D),m=f.font;f.font=q;q=f.measureText(this.mass).width;f.fillText(this.mass,this.x-q-0.5,this.y-j.atoms_font_size_2D*0.3);f.font=m}m=this.getImplicitHydrogenCount();
if(j.atoms_implicitHydrogens_2D&&m>0){p=f.measureText(this.label).width;var t=f.measureText("H").width;if(m>1){var v=p/2+t/2,r=0;q=j.getFontString(j.atoms_font_size_2D*0.8,j.atoms_font_families_2D,j.atoms_font_bold_2D,j.atoms_font_italic_2D);f.font=q;var w=f.measureText(m).width;if(this.bondNumber==1){if(this.angleOfLeastInterference>b.PI/2&&this.angleOfLeastInterference<3*b.PI/2)v=-p/2-w-t/2}else if(!(this.angleOfLeastInterference<=b.PI/4))if(this.angleOfLeastInterference<3*b.PI/4){v=0;r=-j.atoms_font_size_2D*
0.9}else if(this.angleOfLeastInterference<=5*b.PI/4)v=-p/2-w-t/2;else if(this.angleOfLeastInterference<7*b.PI/4){v=0;r=j.atoms_font_size_2D*0.9}f.font=n;f.fillText("H",this.x+v,this.y+r);f.font=q;f.fillText(m,this.x+v+t/2+w/2,this.y+r+j.atoms_font_size_2D*0.3)}else{v=p/2+t/2;r=0;if(this.bondNumber==1){if(this.angleOfLeastInterference>b.PI/2&&this.angleOfLeastInterference<3*b.PI/2)v=-p/2-t/2}else if(!(this.angleOfLeastInterference<=b.PI/4))if(this.angleOfLeastInterference<3*b.PI/4){v=0;r=-j.atoms_font_size_2D*
0.9}else if(this.angleOfLeastInterference<=5*b.PI/4)v=-p/2-t/2;else if(this.angleOfLeastInterference<7*b.PI/4){v=0;r=j.atoms_font_size_2D*0.9}f.fillText("H",this.x+v,this.y+r)}}}if(this.charge!=null&&this.charge!=0){n=this.charge.toFixed(0);if(n=="1")n="+";else if(n=="-1")n="\u2013";else if(a.stringStartsWith(n,"-"))n=n.substring(1)+"\u2013";else n+="+";q=this.angleOfLeastInterference;p=j.atoms_font_size_2D;if(this.isLabelVisible(j)&&m>0)q+=b.PI/4;f.textAlign="center";f.textBaseline="middle";f.fillText(n,
this.x+p*b.cos(q),this.y-p*b.sin(q))}};this.drawDecorations=function(f){if(this.isHover||this.isSelected){f.strokeStyle=this.isHover?"#885110":"#0060B2";f.lineWidth=1.2;f.beginPath();f.arc(this.x,this.y,this.isHover?7:15,0,b.PI*2,false);f.stroke()}};this.render=function(f,j){if(this.specs)j=this.specs;var n=d.translate(f.modelViewMatrix,[this.x,this.y,this.z],[]),p=j.atoms_useVDWDiameters_3D?c[this.label].vdWRadius*j.atoms_vdwMultiplier_3D:j.atoms_sphereDiameter_3D/2;if(p==0)p=1;d.scale(n,[p,p,p]);
f.material.setDiffuseColor(f,j.atoms_useJMOLColors?c[this.label].jmolColor:j.atoms_color);f.setMatrixUniforms(n);f.drawElements(f.TRIANGLES,f.sphereBuffer.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)};this.isLabelVisible=function(f){return this.label!="C"||this.mass!=-1||this.isHidden&&f.atoms_showHiddenCarbons_2D||f.atoms_displayTerminalCarbonLabels_2D&&this.bondNumber==1};this.getImplicitHydrogenCount=function(){if(this.label=="H"||c[this.label]==null)return 0;var f=c[this.label].valency,j=f-
this.coordinationNumber;if(this.charge>0){f=4-f;if(this.charge<=f)j+=this.charge;else j=4-this.coordinationNumber-this.charge+f}else j+=this.charge;return j<0?0:j};return true};k.Atom.prototype=new k.Point(0,0)})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4);
(function(c,a,k,b,d,e){k.Bond=function(l,g,h){this.a1=l;this.a2=g;this.bondOrder=h?h:1;this.stereo=k.Bond.STEREO_NONE;this.isHover=false;this.ring=null;this.getCenter=function(){return new k.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)};this.getLength=function(){return this.a1.distance(this.a2)};this.getLength3D=function(){return this.a1.distance3D(this.a2)};this.contains=function(f){return f==this.a1||f==this.a2};this.getNeighbor=function(f){if(f==this.a1)return this.a2;else if(f==this.a2)return this.a1;
return null};this.draw=function(f,j){if(this.specs)j=this.specs;var n=this.a1.x,p=this.a2.x,q=this.a1.y,m=this.a2.y,t=p-n,v=m-q;if(j.atoms_display&&!j.atoms_circles_2D&&this.a1.isLabelVisible(j)){n+=t*j.bonds_atomLabelBuffer_2D;q+=v*j.bonds_atomLabelBuffer_2D}if(j.atoms_display&&!j.atoms_circles_2D&&this.a2.isLabelVisible(j)){p-=t*j.bonds_atomLabelBuffer_2D;m-=v*j.bonds_atomLabelBuffer_2D}if(j.bonds_clearOverlaps_2D){var r=n+t*0.15,w=q+v*0.15,u=p-t*0.15,x=m-v*0.15;f.strokeStyle=j.backgroundColor;
f.lineWidth=j.bonds_width_2D+j.bonds_overlapClearWidth_2D*2;f.lineCap="round";f.beginPath();f.moveTo(r,w);f.lineTo(u,x);f.closePath();f.stroke()}f.strokeStyle=j.bonds_color;f.fillStyle=j.bonds_color;f.lineWidth=j.bonds_width_2D;f.lineCap=j.bonds_ends_2D;if(j.bonds_useJMOLColors){r=f.createLinearGradient(n,q,p,m);w=c[this.a1.label].jmolColor;u=c[this.a2.label].jmolColor;r.addColorStop(0,w);if(!j.bonds_colorGradient){r.addColorStop(0.5,w);r.addColorStop(0.51,u)}r.addColorStop(1,u);f.strokeStyle=r;f.fillStyle=
r}switch(this.bondOrder){case 0.5:f.beginPath();f.moveTo(n,q);a.contextHashTo(f,n,q,p,m,j.bonds_hashSpacing_2D,j.bonds_hashSpacing_2D);f.stroke();break;case 1:if(this.stereo==k.Bond.STEREO_PROTRUDING||this.stereo==k.Bond.STEREO_RECESSED){var z=j.bonds_width_2D/2;v=this.a1.distance(this.a2)*j.bonds_wedgeThickness_2D/2;r=this.a1.angle(this.a2)+b.PI/2;w=b.cos(r);r=b.sin(r);t=n-w*z;u=q+r*z;x=n+w*z;z=q-r*z;var A=p+w*v,B=m-r*v;w=p-w*v;r=m+r*v;f.beginPath();f.moveTo(t,u);f.lineTo(x,z);f.lineTo(A,B);f.lineTo(w,
r);f.closePath();if(this.stereo==k.Bond.STEREO_PROTRUDING)f.fill();else{f.save();f.clip();f.lineWidth=v*2;f.lineCap="butt";f.beginPath();f.moveTo(n,q);a.contextHashTo(f,n,q,p,m,j.bonds_hashWidth_2D,j.bonds_hashSpacing_2D);f.stroke();f.restore()}}else if(this.stereo==k.Bond.STEREO_AMBIGUOUS){f.beginPath();f.moveTo(n,q);m=b.floor(b.sqrt(t*t+v*v)/j.bonds_wavyLength_2D);n=n;q=q;r=this.a1.angle(this.a2)+b.PI/2;w=b.cos(r);r=b.sin(r);p=t/m;v=v/m;for(A=0;A<m;A++){n+=p;q+=v;t=j.bonds_wavyLength_2D*w+n-p*0.5;
x=j.bonds_wavyLength_2D*-r+q-v*0.5;u=j.bonds_wavyLength_2D*-w+n-p*0.5;z=j.bonds_wavyLength_2D*r+q-v*0.5;A%2==0?f.quadraticCurveTo(t,x,n,q):f.quadraticCurveTo(u,z,n,q)}f.stroke();break}else{f.beginPath();f.moveTo(n,q);f.lineTo(p,m);f.stroke()}break;case 1.5:f.beginPath();f.moveTo(n,q);f.lineTo(p,m);f.stroke();break;case 2:if(this.stereo==k.Bond.STEREO_AMBIGUOUS){v=this.a1.distance(this.a2)*j.bonds_saturationWidth_2D/2;r=this.a1.angle(this.a2)+b.PI/2;t=n-b.cos(r)*v;u=q+b.sin(r)*v;x=n+b.cos(r)*v;z=q-
b.sin(r)*v;A=p+b.cos(r)*v;B=m-b.sin(r)*v;w=p-b.cos(r)*v;r=m+b.sin(r)*v;f.beginPath();f.moveTo(t,u);f.lineTo(A,B);f.moveTo(x,z);f.lineTo(w,r);f.stroke()}else if(!j.bonds_symmetrical_2D&&(this.ring!=null||this.a1.label=="C"&&this.a2.label=="C")){f.beginPath();f.moveTo(n,q);f.lineTo(p,m);w=0;u=this.a1.distance(this.a2);t=this.a1.angle(this.a2);r=t+b.PI/2;v=u*j.bonds_saturationWidth_2D;x=j.bonds_saturationAngle_2D;if(x<b.PI/2)w=-(v/b.tan(x));if(b.abs(w)<u/2){x=n-b.cos(t)*w;n=p+b.cos(t)*w;p=q+b.sin(t)*
w;q=m-b.sin(t)*w;t=x-b.cos(r)*v;u=p+b.sin(r)*v;x=x+b.cos(r)*v;z=p-b.sin(r)*v;A=n-b.cos(r)*v;B=q+b.sin(r)*v;w=n+b.cos(r)*v;r=q-b.sin(r)*v;if(this.ring==null||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>b.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-b.PI){f.moveTo(t,u);f.lineTo(A,B)}else{f.moveTo(x,z);f.lineTo(w,r)}f.stroke()}}else{v=this.a1.distance(this.a2)*j.bonds_saturationWidth_2D/2;
r=this.a1.angle(this.a2)+b.PI/2;t=n-b.cos(r)*v;u=q+b.sin(r)*v;x=n+b.cos(r)*v;z=q-b.sin(r)*v;A=p+b.cos(r)*v;B=m-b.sin(r)*v;w=p-b.cos(r)*v;r=m+b.sin(r)*v;f.beginPath();f.moveTo(t,u);f.lineTo(w,r);f.moveTo(x,z);f.lineTo(A,B);f.stroke()}break;case 3:v=this.a1.distance(this.a2)*j.bonds_saturationWidth_2D;r=this.a1.angle(this.a2)+b.PI/2;t=n-b.cos(r)*v;u=q+b.sin(r)*v;x=n+b.cos(r)*v;z=q-b.sin(r)*v;A=p+b.cos(r)*v;B=m-b.sin(r)*v;w=p-b.cos(r)*v;r=m+b.sin(r)*v;f.beginPath();f.moveTo(t,u);f.lineTo(w,r);f.moveTo(x,
z);f.lineTo(A,B);f.moveTo(n,q);f.lineTo(p,m);f.stroke();break}};this.drawDecorations=function(f){if(this.isHover||this.isSelected){var j=2*b.PI,n=(this.a1.angleForStupidCanvasArcs(this.a2)+b.PI/2)%j;f.strokeStyle=this.isHover?"#885110":"#0060B2";f.lineWidth=1.2;f.beginPath();var p=(n+b.PI)%j;p%=b.PI*2;f.arc(this.a1.x,this.a1.y,7,n,p,false);f.stroke();f.beginPath();n+=b.PI;p=(n+b.PI)%j;f.arc(this.a2.x,this.a2.y,7,n,p,false);f.stroke()}};this.render=function(f,j){if(this.specs)j=this.specs;var n=1.001*
this.a1.distance3D(this.a2)/(j.bonds_useJMOLColors?2:1);if(n==0)return false;n=[j.bonds_cylinderDiameter_3D/2,n,j.bonds_cylinderDiameter_3D/2];var p=d.translate(f.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),q=null,m=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];if(j.bonds_useJMOLColors){e.scale(m,0.5);q=d.translate(f.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[])}var t=[0],v=null;if(j.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:t=[-j.bonds_cylinderDiameter_3D,
j.bonds_cylinderDiameter_3D];break;case 3:t=[-1.2*j.bonds_cylinderDiameter_3D,0,1.2*j.bonds_cylinderDiameter_3D];break}if(t.length>1){v=[0,0,1];var r=d.inverse(f.rotationMatrix,[]);d.multiplyVec3(r,v);v=e.cross(m,v,[]);e.normalize(v)}}var w=[0,1,0];r=0;var u=null;if(this.a1.x==this.a2.x&&this.a1.z==this.a2.z){u=[0,0,1];if(this.a2.y<this.a1.y)r=b.PI}else{r=a.vec3AngleFrom(w,m);u=e.cross(w,m,[])}m=0;for(w=t.length;m<w;m++){var x=d.set(p,[]);t[m]!=0&&d.translate(x,e.scale(v,t[m],[]));r!=0&&d.rotate(x,
r,u);d.scale(x,n);f.material.setDiffuseColor(f,j.bonds_useJMOLColors?c[this.a1.label].jmolColor:j.bonds_color);f.setMatrixUniforms(x);f.drawArrays(f.TRIANGLE_STRIP,0,f.cylinderBuffer.vertexPositionBuffer.numItems);if(j.bonds_useJMOLColors){d.set(q,x);t[m]!=0&&d.translate(x,e.scale(v,t[m],[]));d.rotate(x,r+b.PI,u);d.scale(x,n);f.material.setDiffuseColor(f,c[this.a2.label].jmolColor);f.setMatrixUniforms(x);f.drawArrays(f.TRIANGLE_STRIP,0,f.cylinderBuffer.vertexPositionBuffer.numItems)}}};return true};
k.Bond.STEREO_NONE="none";k.Bond.STEREO_PROTRUDING="protruding";k.Bond.STEREO_RECESSED="recessed";k.Bond.STEREO_AMBIGUOUS="ambiguous"})(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4,vec3);
(function(c,a){c.Ring=function(){this.atoms=[];this.bonds=[];this.center=null;this.setupBonds=function(){for(var k=0,b=this.bonds.length;k<b;k++)this.bonds[k].ring=this;this.center=this.getCenter()};this.getCenter=function(){for(var k=minY=Infinity,b=maxY=-Infinity,d=0,e=this.atoms.length;d<e;d++){k=a.min(this.atoms[d].x,k);minY=a.min(this.atoms[d].y,minY);b=a.max(this.atoms[d].x,b);maxY=a.max(this.atoms[d].y,maxY)}return new c.Point((b+k)/2,(maxY+minY)/2)};return true}})(ChemDoodle.structures,Math);
(function(c,a,k){a.Molecule=function(){this.atoms=[];this.bonds=[];this.rings=[];this.findRings=true;this.draw=function(b,d){if(this.specs)d=this.specs;if(d.bonds_display)for(var e=0,l=this.bonds.length;e<l;e++)this.bonds[e].draw(b,d);if(d.atoms_display){e=0;for(l=this.atoms.length;e<l;e++)this.atoms[e].draw(b,d)}};this.render=function(b,d){if(this.specs)d=this.specs;var e=this.atoms.length>0&&this.atoms[0].hetatm!=undefined;if(e){if(d.macro_displayBonds){if(this.bonds.length>0){b.cylinderBuffer.bindBuffers();
b.material.setTempColors(b,d.bonds_materialAmbientColor_3D,null,d.bonds_materialSpecularColor_3D,d.bonds_materialShininess_3D)}for(var l=0,g=this.bonds.length;l<g;l++){var h=this.bonds[l];if(!h.a1.hetatm&&(d.macro_atomToLigandDistance==-1||h.a1.closestDistance!=undefined&&d.macro_atomToLigandDistance>=h.a1.closestDistance&&d.macro_atomToLigandDistance>=h.a2.closestDistance))h.render(b,this.residueSpecs?this.residueSpecs:d)}}if(d.macro_displayAtoms){if(this.atoms.length>0){b.sphereBuffer.bindBuffers();
b.material.setTempColors(b,d.atoms_materialAmbientColor_3D,null,d.atoms_materialSpecularColor_3D,d.atoms_materialShininess_3D)}l=0;for(g=this.atoms.length;l<g;l++){h=this.atoms[l];if(!h.hetatm&&(d.macro_atomToLigandDistance==-1||h.closestDistance!=undefined&&d.macro_atomToLigandDistance>=h.closestDistance))h.render(b,this.residueSpecs?this.residueSpecs:d)}}}if(d.bonds_display){if(this.bonds.length>0){b.cylinderBuffer.bindBuffers();b.material.setTempColors(b,d.bonds_materialAmbientColor_3D,null,d.bonds_materialSpecularColor_3D,
d.bonds_materialShininess_3D)}l=0;for(g=this.bonds.length;l<g;l++){h=this.bonds[l];if(!e||h.a1.hetatm)h.render(b,d)}}if(d.atoms_display){if(this.atoms.length>0){b.sphereBuffer.bindBuffers();b.material.setTempColors(b,d.atoms_materialAmbientColor_3D,null,d.atoms_materialSpecularColor_3D,d.atoms_materialShininess_3D)}l=0;for(g=this.atoms.length;l<g;l++){h=this.atoms[l];if(!e||h.hetatm&&(d.macro_showWater||!h.isWater))h.render(b,d)}}if(this.chains){b.setMatrixUniforms(b.modelViewMatrix);if(d.proteins_displayRibbon){b.material.setTempColors(b,
d.proteins_materialAmbientColor_3D,null,d.proteins_materialSpecularColor_3D,d.proteins_materialShininess_3D);e=0;for(h=this.ribbons.length;e<h;e++)if(d.proteins_useShapelyColors||d.proteins_useAminoColors){var f=d.proteins_ribbonCartoonize?this.cartoons[e]:this.ribbons[e];f.front.bindBuffers();l=0;for(g=f.front.segments.length;l<g;l++)f.front.segments[l].render(b,d);f.back.bindBuffers();l=0;for(g=f.back.segments.length;l<g;l++)f.back.segments[l].render(b,d)}else if(d.proteins_ribbonCartoonize){f=
this.cartoons[e];f.front.bindBuffers();l=0;for(g=f.front.cartoonSegments.length;l<g;l++)f.front.cartoonSegments[l].render(b,d);f.back.bindBuffers();l=0;for(g=f.back.cartoonSegments.length;l<g;l++)f.back.cartoonSegments[l].render(b,d)}else{f=this.ribbons[e];f.front.render(b,d);f.back.render(b,d)}}if(d.nucleics_display){b.material.setTempColors(b,d.nucleics_materialAmbientColor_3D,null,d.nucleics_materialSpecularColor_3D,d.nucleics_materialShininess_3D);e=0;for(h=this.tubes.length;e<h;e++){b.setMatrixUniforms(b.modelViewMatrix);
f=this.tubes[e];f.render(b,d)}}}if(d.crystals_displayUnitCell&&this.unitCell){b.setMatrixUniforms(b.modelViewMatrix);this.unitCell.bindBuffers();b.material.setDiffuseColor(b,d.crystals_unitCellColor);b.lineWidth(d.crystals_unitCellLineWidth);b.drawElements(b.LINES,this.unitCell.vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)}};this.getCenter3D=function(){if(this.atoms.length==1)return new a.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var b=minY=minZ=Infinity,d=maxY=maxZ=-Infinity;if(this.chains)for(var e=
0,l=this.chains.length;e<l;e++)for(var g=this.chains[e],h=0,f=g.length;h<f;h++){var j=g[h];b=k.min(j.cp1.x,b);minY=k.min(j.cp1.y,minY);minZ=k.min(j.cp1.z,minZ);d=k.max(j.cp1.x,d);maxY=k.max(j.cp1.y,maxY);maxZ=k.max(j.cp1.z,maxZ);b=k.min(j.cp2.x,b);minY=k.min(j.cp2.y,minY);minZ=k.min(j.cp2.z,minZ);d=k.max(j.cp2.x,d);maxY=k.max(j.cp2.y,maxY);maxZ=k.max(j.cp2.z,maxZ)}e=0;for(l=this.atoms.length;e<l;e++){b=k.min(this.atoms[e].x,b);minY=k.min(this.atoms[e].y,minY);minZ=k.min(this.atoms[e].z,minZ);d=k.max(this.atoms[e].x,
d);maxY=k.max(this.atoms[e].y,maxY);maxZ=k.max(this.atoms[e].z,maxZ)}return new a.Atom("C",(d+b)/2,(maxY+minY)/2,(maxZ+minZ)/2)};this.getCenter=function(){if(this.atoms.length==1)return new a.Point(this.atoms[0].x,this.atoms[0].y);for(var b=minY=Infinity,d=maxY=-Infinity,e=0,l=this.atoms.length;e<l;e++){b=k.min(this.atoms[e].x,b);minY=k.min(this.atoms[e].y,minY);d=k.max(this.atoms[e].x,d);maxY=k.max(this.atoms[e].y,maxY)}return new a.Point((d+b)/2,(maxY+minY)/2)};this.getDimension=function(){if(this.atoms.length==
1)return new a.Point(0,0);var b=minY=Infinity,d=maxY=-Infinity;if(this.chains){for(var e=0,l=this.chains.length;e<l;e++)for(var g=this.chains[e],h=0,f=g.length;h<f;h++){var j=g[h];b=k.min(j.cp1.x,b);minY=k.min(j.cp1.y,minY);d=k.max(j.cp1.x,d);maxY=k.max(j.cp1.y,maxY);b=k.min(j.cp2.x,b);minY=k.min(j.cp2.y,minY);d=k.max(j.cp2.x,d);maxY=k.max(j.cp2.y,maxY)}b-=30;minY-=30;minZ-=30;d+=30;maxY+=30;maxZ+=30}e=0;for(l=this.atoms.length;e<l;e++){b=k.min(this.atoms[e].x,b);minY=k.min(this.atoms[e].y,minY);
d=k.max(this.atoms[e].x,d);maxY=k.max(this.atoms[e].y,maxY)}return new a.Point(d-b,maxY-minY)};this.check=function(){if(this.findRings){this.rings=(new c.informatics.SSSRFinder(this)).rings;for(var b=0,d=this.bonds.length;b<d;b++)this.bonds[b].ring=null;b=0;for(d=this.rings.length;b<d;b++)this.rings[b].setupBonds()}b=0;for(d=this.atoms.length;b<d;b++){this.atoms[b].isLone=false;if(this.atoms[b].label=="C"){for(var e=0,l=0,g=this.bonds.length;l<g;l++)if(this.bonds[l].a1==this.atoms[b]||this.bonds[l].a2==
this.atoms[b])e++;if(e==0)this.atoms[b].isLone=true}}e=false;b=0;for(d=this.atoms.length;b<d;b++)if(this.atoms[b].z!=0)e=true;if(e){this.sortAtomsByZ();this.sortBondsByZ()}this.setupMetaData()};this.getAngles=function(b){for(var d=[],e=0,l=this.bonds.length;e<l;e++)this.bonds[e].contains(b)&&d.push(b.angle(this.bonds[e].getNeighbor(b)));d.sort();return d};this.getCoordinationNumber=function(b){for(var d=0,e=0,l=b.length;e<l;e++)d+=b[e].bondOrder;return d};this.getBonds=function(b){for(var d=[],e=
0,l=this.bonds.length;e<l;e++)this.bonds[e].contains(b)&&d.push(this.bonds[e]);return d};this.sortAtomsByZ=function(){for(var b=1,d=this.atoms.length;b<d;b++)for(var e=b;e>0&&this.atoms[e].z<this.atoms[e-1].z;){var l=this.atoms[e];this.atoms[e]=this.atoms[e-1];this.atoms[e-1]=l;e--}};this.sortBondsByZ=function(){for(var b=1,d=this.bonds.length;b<d;b++)for(var e=b;e>0&&this.bonds[e].a1.z+this.bonds[e].a2.z<this.bonds[e-1].a1.z+this.bonds[e-1].a2.z;){var l=this.bonds[e];this.bonds[e]=this.bonds[e-1];
this.bonds[e-1]=l;e--}};this.setupMetaData=function(){for(var b=0,d=this.atoms.length;b<d;b++){var e=this.atoms[b],l=this.getBonds(e),g=this.getAngles(e);e.isHidden=l.length==2&&k.abs(k.abs(g[1]-g[0])-k.PI)<k.PI/30&&l[0].bondOrder==l[1].bondOrder;e.angleOfLeastInterference=c.math.angleBetweenLargest(g)%(k.PI*2);e.coordinationNumber=this.getCoordinationNumber(l);e.bondNumber=l.length}};this.scaleToAverageBondLength=function(b){var d=this.getAverageBondLength();if(d!=0){b=b/d;d=0;for(var e=this.atoms.length;d<
e;d++){this.atoms[d].x*=b;this.atoms[d].y*=b}}};this.getAverageBondLength=function(){if(this.bonds.length==0)return 0;for(var b=0,d=0,e=this.bonds.length;d<e;d++)b+=this.bonds[d].getLength();b/=this.bonds.length;return b};return true}})(ChemDoodle,ChemDoodle.structures,Math);
(function(c,a,k,b){var d=[6/a.pow(10,3),0,0,0,6/a.pow(10,3),2/a.pow(10,2),0,0,1/a.pow(10,3),1/a.pow(10,2),0.1,0,0,0,0,1],e=k.multiply([-1/6,0.5,-0.5,1/6,0.5,-1,0.5,0,-0.5,0,0.5,0,1/6,2/3,1/6,0],d,[]);c.Residue=function(l){this.Ns=9;this.resSeq=l;this.setup=function(g){var h=[g.x-this.cp1.x,g.y-this.cp1.y,g.z-this.cp1.z],f=b.cross(h,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);this.D=b.cross(f,h,[]);b.normalize(f);b.normalize(this.D);this.guidePointsSmall=[];this.guidePointsLarge=
[];g=[(g.x+this.cp1.x)/2,(g.y+this.cp1.y)/2,(g.z+this.cp1.z)/2];if(this.helix){b.scale(f,1.5);b.add(g,f)}this.guidePointsSmall[0]=new c.Atom("",g[0]-this.D[0]/2,g[1]-this.D[1]/2,g[2]-this.D[2]/2);for(f=1;f<this.Ns;f++)this.guidePointsSmall[f]=new c.Atom("",this.guidePointsSmall[0].x+this.D[0]*f/this.Ns,this.guidePointsSmall[0].y+this.D[1]*f/this.Ns,this.guidePointsSmall[0].z+this.D[2]*f/this.Ns);b.scale(this.D,4);this.guidePointsLarge[0]=new c.Atom("",g[0]-this.D[0]/2,g[1]-this.D[1]/2,g[2]-this.D[2]/
2);for(f=1;f<this.Ns;f++)this.guidePointsLarge[f]=new c.Atom("",this.guidePointsLarge[0].x+this.D[0]*f/this.Ns,this.guidePointsLarge[0].y+this.D[1]*f/this.Ns,this.guidePointsLarge[0].z+this.D[2]*f/this.Ns)};this.getGuidePointSet=function(g){if(g==0)return this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall;else if(g==1)return this.guidePointsSmall;else if(g==2)return this.guidePointsLarge};this.computeLineSegments=function(g,h,f,j){this.split=h.helix!=this.helix||h.sheet!=this.sheet;
this.lineSegments=this.innerCompute(0,g,h,f,false);if(j)this.lineSegmentsCartoon=this.innerCompute(h.helix||h.sheet?2:1,g,h,f,true)};this.innerCompute=function(g,h,f,j,n){var p=[],q=this.getGuidePointSet(g);h=h.getGuidePointSet(g);f=f.getGuidePointSet(g);for(var m=j.getGuidePointSet(g),t=0,v=this.guidePointsLarge.length;t<v;t++){for(var r=k.multiply([h[t].x,h[t].y,h[t].z,1,q[t].x,q[t].y,q[t].z,1,f[t].x,f[t].y,f[t].z,1,m[t].x,m[t].y,m[t].z,1],e,[]),w=[],u=0;u<10;u++){for(g=3;g>0;g--)for(j=0;j<4;j++)r[g*
4+j]+=r[(g-1)*4+j];w[u]=new c.Atom("",r[12]/r[15],r[13]/r[15],r[14]/r[15])}p[t]=w}if(n&&this.arrow)for(g=0;g<10;g++){n=1.5-1.3*g/10;q=a.floor(this.Ns/2);h=p[q];j=0;for(f=p.length;j<f;j++)if(j!=q){m=h[g];t=p[j][g];v=[t.x-m.x,t.y-m.y,t.z-m.z];b.scale(v,n);t.x=m.x+v[0];t.y=m.y+v[1];t.z=m.z+v[2]}}return p}}})(ChemDoodle.structures,Math,mat4,vec3);
(function(c,a,k,b,d){a.Spectrum=function(){this.data=[];this.metadata=[];this.dataDisplay=[];this.yUnit=this.xUnit=this.title=null;this.continuous=true;this.integrationSensitivity=0.01;var e=0,l=false;this.draw=function(g,h,f,j){var n=5,p=0,q=0;g.fillStyle=h.text_color;g.textAlign="center";g.textBaseline="alphabetic";g.font=h.getFontString(h.text_font_size,h.text_font_families);if(this.xUnit){q+=h.text_font_size;g.fillText(this.xUnit,f/2,j-2)}if(this.yUnit&&h.plots_showYAxis){p+=h.text_font_size;
g.save();g.translate(h.text_font_size,j/2);g.rotate(-d.PI/2);g.fillText(this.yUnit,0,0);g.restore()}if(this.title!=null){n+=h.text_font_size;g.fillText(this.title,f/2,h.text_font_size)}q+=5+h.text_font_size;if(h.plots_showYAxis)p+=5+g.measureText("1000").width;if(h.plots_showGrid){g.strokeStyle=h.plots_gridColor;g.lineWidth=h.plots_gridLineWidth;g.strokeRect(p,n,f-p,j-q-n)}g.textAlign="center";g.textBaseline="top";for(var m=this.maxX-this.minX,t=m/100,v=0.0010;v<t||m/v>25;)v*=10;var r=0,w=h.plots_flipXAxis?
f:0;for(m=d.round(this.minX/v)*v;m<=this.maxX;m+=v/2){t=this.getTransformedX(m,h,f,p);if(t>p){g.strokeStyle="black";g.lineWidth=1;if(r%2==0){g.beginPath();g.moveTo(t,j-q);g.lineTo(t,j-q+2);g.stroke();for(var u=m.toFixed(5);u.charAt(u.length-1)=="0";)u=u.substring(0,u.length-1);if(u.charAt(u.length-1)==".")u=u.substring(0,u.length-1);var x=g.measureText(u).width;if(h.plots_flipXAxis)x*=-1;var z=t-x/2;if(h.plots_flipXAxis?z<w:z>w){g.fillText(u,t,j-q+2);w=t+x/2}if(h.plots_showGrid){g.strokeStyle=h.plots_gridColor;
g.lineWidth=h.plots_gridLineWidth;g.beginPath();g.moveTo(t,j-q);g.lineTo(t,n);g.stroke()}}else{g.beginPath();g.moveTo(t,j-q);g.lineTo(t,j-q+2);g.stroke()}}r++}if(h.plots_showYAxis||h.plots_showGrid){t=1/h.scale;g.textAlign="right";g.textBaseline="middle";for(m=0;m<=10;m++){u=t/10*m;v=n+(j-q-n)*(1-u*h.scale);if(h.plots_showGrid){g.strokeStyle=h.plots_gridColor;g.lineWidth=h.plots_gridLineWidth;g.beginPath();g.moveTo(p,v);g.lineTo(f,v);g.stroke()}if(h.plots_showYAxis){g.strokeStyle="black";g.lineWidth=
1;g.beginPath();g.moveTo(p,v);g.lineTo(p-3,v);g.stroke();u=u*100;r=d.max(0,3-d.floor(u).toString().length);u=u.toFixed(r);if(r>0)for(;u.charAt(u.length-1)=="0";)u=u.substring(0,u.length-1);if(u.charAt(u.length-1)==".")u=u.substring(0,u.length-1);g.fillText(u,p-3,v)}}}g.strokeStyle="black";g.lineWidth=1;g.beginPath();g.moveTo(f,j-q);g.lineTo(p,j-q);h.plots_showYAxis&&g.lineTo(p,n);g.stroke();if(this.dataDisplay.length>0){g.textAlign="left";g.textBaseline="top";m=t=0;for(u=this.dataDisplay.length;m<
u;m++)if(this.dataDisplay[m].value){g.fillText([this.dataDisplay[m].display,": ",this.dataDisplay[m].value].join(""),p+10,n+10+t*(h.text_font_size+5));t++}else if(this.dataDisplay[m].tag){v=0;for(r=this.metadata.length;v<r;v++)if(c.stringStartsWith(this.metadata[v],this.dataDisplay[m].tag)){r=this.metadata[v];if(this.dataDisplay[m].display){r=b.inArray("=",this.metadata[v]);r=[this.dataDisplay[m].display,": ",r>-1?this.metadata[v].substring(r+2):this.metadata[v]].join("")}g.fillText(r,p+10,n+10+t*
(h.text_font_size+5));t++;break}}}g.strokeStyle=h.plots_color;g.lineWidth=h.plots_width;r=[];g.beginPath();if(this.continuous){w=false;m=0;for(u=this.data.length;m<u;m++){t=this.getTransformedX(this.data[m].x,h,f,p);if(t>=p&&t<f){v=this.getTransformedY(this.data[m].y,h,j,q,n);h.plots_showIntegration&&d.abs(this.data[m].y)>this.integrationSensitivity&&r.push(new a.Point(this.data[m].x,this.data[m].y));if(!w){g.moveTo(t,v);w=true}g.lineTo(t,v)}else if(w)break}}else{m=0;for(u=this.data.length;m<u;m++){t=
this.getTransformedX(this.data[m].x,h,f,p);if(t>=p&&t<f){g.moveTo(t,j-q);g.lineTo(t,this.getTransformedY(this.data[m].y,h,j,q,n))}}}g.stroke();if(h.plots_showIntegration&&r.length>1){g.strokeStyle=h.plots_integrationColor;g.lineWidth=h.plots_integrationLineWidth;g.beginPath();m=r[1].x>r[0].x;if(this.flipXAxis&&!m||!this.flipXAxis&&m){for(m=r.length-2;m>=0;m--)r[m].y+=r[m+1].y;w=r[0].y}else{m=1;for(u=r.length;m<u;m++)r[m].y+=r[m-1].y;w=r[r.length-1].y}m=0;for(u=r.length;m<u;m++){t=this.getTransformedX(r[m].x,
h,f,p);v=this.getTransformedY(r[m].y/h.scale/w,h,j,q,n);m==0?g.moveTo(t,v):g.lineTo(t,v)}g.stroke()}e=p;l=h.plots_flipXAxis};this.getTransformedY=function(g,h,f,j,n){return n+(f-j-n)*(1-g*h.scale)};this.getTransformedX=function(g,h,f,j){g=j+(g-this.minX)/(this.maxX-this.minX)*(f-j);if(h.plots_flipXAxis)g=f+j-g;return g};this.getInverseTransformedX=function(g,h,f){if(l)g=h+f-g;return(g-f)*(this.maxX-this.minX)/(h-f)+this.minX};this.setup=function(){for(var g=Number.MAX_VALUE,h=Number.MIN_VALUE,f=Number.MIN_VALUE,
j=0,n=this.data.length;j<n;j++){g=d.min(g,this.data[j].x);h=d.max(h,this.data[j].x);f=d.max(f,this.data[j].y)}if(this.continuous){this.minX=g;this.maxX=h}else{this.minX=g-1;this.maxX=h+1}j=0;for(n=this.data.length;j<n;j++)this.data[j].y/=f};this.zoom=function(g,h,f,j){g=this.getInverseTransformedX(g,f,e);h=this.getInverseTransformedX(h,f,e);this.minX=d.min(g,h);this.maxX=d.max(g,h);if(j){j=Number.MIN_VALUE;h=0;for(f=this.data.length;h<f;h++)if(k.isBetween(this.data[h].x,this.minX,this.maxX))j=d.max(j,
this.data[h].y);return 1/j}};this.translate=function(g,h){var f=g/(h-e)*(this.maxX-this.minX)*(l?1:-1);this.minX+=f;this.maxX+=f};this.alertMetadata=function(){alert(this.metadata.join("\n"))};return true}})(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math);
(function(c){c._Mesh=function(){return true};c._Mesh.prototype.setupBuffers=function(a,k,b,d){if(a){this.gl=a;this.vertexPositionBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array(k),a.STATIC_DRAW);this.vertexPositionBuffer.itemSize=3;this.vertexPositionBuffer.numItems=k.length/3;this.vertexNormalBuffer=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);
this.vertexNormalBuffer.itemSize=3;this.vertexNormalBuffer.numItems=b.length/3;if(d){this.vertexIndexBuffer=a.createBuffer();a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=d.length}}};c._Mesh.prototype.bindBuffers=function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexPositionBuffer);this.gl.vertexAttribPointer(this.gl.shader.vertexPositionAttribute,
this.vertexPositionBuffer.itemSize,this.gl.FLOAT,false,0,0);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexNormalBuffer);this.gl.vertexAttribPointer(this.gl.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,this.gl.FLOAT,false,0,0);this.vertexIndexBuffer&&this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}})(ChemDoodle.structures,Math);
(function(c,a){c.Cylinder=function(k,b,d,e){for(var l=[],g=[],h=0;h<e;h++){var f=h*2*a.PI/e,j=a.cos(f);f=a.sin(f);g.push(j,0,f);l.push(b*j,0,b*f);g.push(j,0,f);l.push(b*j,d,b*f)}g.push(1,0,0);l.push(b,0,0);g.push(1,0,0);l.push(b,d,0);this.setupBuffers(k,l,g);return true};c.Cylinder.prototype=new c._Mesh})(ChemDoodle.structures,Math);
(function(c,a){c.Sphere=function(k,b,d,e){for(var l=[],g=[],h=0;h<=d;h++){var f=h*a.PI/d,j=a.sin(f),n=a.cos(f);for(f=0;f<=e;f++){var p=f*2*a.PI/e,q=a.sin(p);p=a.cos(p)*j;var m=n;q=q*j;g.push(p,m,q);l.push(b*p,b*m,b*q)}}b=[];e+=1;for(h=0;h<d;h++)for(f=0;f<e;f++){j=h*e+f%e;n=j+e;b.push(j);b.push(n);b.push(j+1);if(f<e-1){b.push(n);b.push(n+1);b.push(j+1)}}this.setupBuffers(k,l,g,b);return true};c.Sphere.prototype=new c._Mesh})(ChemDoodle.structures,Math);
(function(c,a,k,b){function d(e,l,g,h){this.name=g;this.entire=l;this.vertexIndexBuffer=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),e.STATIC_DRAW);this.vertexIndexBuffer.itemSize=1;this.vertexIndexBuffer.numItems=h.length;this.getColor=function(f){return this.name?c[this.name]?f.proteins_useShapelyColors?c[this.name].shapelyColor:c[this.name].aminoColor:f.proteins_useShapelyColors?c["*"].shapelyColor:c["*"].aminoColor:
this.helix?l.front?f.proteins_ribbonCartoonHelixPrimaryColor:f.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?f.proteins_ribbonCartoonSheetColor:l.front?f.proteins_primaryColor:f.proteins_secondaryColor};this.render=function(f,j){f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer);f.material.setDiffuseColor(f,this.getColor(j));f.drawElements(f.TRIANGLES,this.vertexIndexBuffer.numItems,f.UNSIGNED_SHORT,0)}}a.Ribbon=function(e,l,g,h){var f=l[0].lineSegments.length,j=l[0].lineSegments[0].length,
n=[],p=[];this.front=g>0;for(var q=0,m=l.length-1;q<m;q++)for(var t=l[q],v=0;v<f;v++)for(var r=h?t.lineSegmentsCartoon[v]:t.lineSegments[v],w=v==0,u=false,x=0;x<j;x++){var z=r[x],A=q,B=x+1;if(q==l.length-2&&x==j-1)B--;else if(x==j-1){A++;B=0}B=h?l[A].lineSegmentsCartoon[v][B]:l[A].lineSegments[v][B];A=false;var F=v+1;if(v==f-1){F-=2;A=true}F=h?t.lineSegmentsCartoon[F][x]:t.lineSegments[F][x];B=[B.x-z.x,B.y-z.y,B.z-z.z];F=[F.x-z.x,F.y-z.y,F.z-z.z];var G=b.cross(B,F,[]);if(x==0){b.normalize(B);b.scale(B,
-1);p.push(B[0],B[1],B[2]);n.push(z.x,z.y,z.z)}if(w||u){b.normalize(F);b.scale(F,-1);p.push(F[0],F[1],F[2]);n.push(z.x,z.y,z.z);if(w&&x==j-1){w=false;x=-1}}else{b.normalize(G);if(A&&!this.front||!A&&this.front)b.scale(G,-1);p.push(G[0],G[1],G[2]);b.scale(G,k.abs(g));n.push(z.x+G[0],z.y+G[1],z.z+G[2]);if(v==f-1&&x==j-1){u=true;x=-1}}if(x==-1||x==j-1){b.normalize(B);p.push(B[0],B[1],B[2]);n.push(z.x,z.y,z.z)}}f+=2;j+=2;this.segments=[];var C;if(h){this.cartoonSegments=[];C=[]}g=[];q=0;for(m=l.length-
1;q<m;q++){if(q>0&&C)if(l[q].split){v=new d(e,this,null,C);if(l[q].helix)v.helix=true;if(l[q].sheet)v.sheet=true;this.cartoonSegments.push(v);C=[]}h=q*f*j;t=[];v=0;for(r=f-1;v<r;v++){w=h+v*j;for(x=0;x<j;x++){u=1;if(q==l.length-2)u=0;else if(x==j-1)u=f*j-x;u=[w+x,w+j+x,w+j+x+u,w+x,w+x+u,w+j+x+u];if(x!=j-1)for(z=0;z<6;z++)t.push(u[z]);if(x==j-2&&q<l.length-3){z=f*j-x;u[2]+=z;u[4]+=z;u[5]+=z}for(z=0;z<6;z++)g.push(u[z]);if(C)for(z=0;z<6;z++)C.push(u[z])}}this.segments.push(new d(e,this,l[q+1].name,t))}C&&
this.cartoonSegments.push(new d(e,this,null,C));this.setupBuffers(e,n,p,g);this.render=function(D,E){this.bindBuffers();D.material.setDiffuseColor(D,this.front?E.proteins_primaryColor:E.proteins_secondaryColor);D.drawElements(D.TRIANGLES,this.vertexIndexBuffer.numItems,D.UNSIGNED_SHORT,0)};return true};a.Ribbon.prototype=new a._Mesh})(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3);
(function(c,a,k){a.Light=function(b,d,e){this.diffuseRGB=c.getRGB(b,1);this.specularRGB=c.getRGB(d,1);this.direction=e;this.lightScene=function(l){l.uniform3f(l.getUniformLocation(l.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]);l.uniform3f(l.getUniformLocation(l.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var g=k.create(this.direction);k.normalize(g);k.negate(g);l.uniform3f(l.getUniformLocation(l.program,
"u_light.direction"),g[0],g[1],g[2]);var h=[0,0,0];g=[h[0]+g[0],h[1]+g[1],h[2]+g[2]];h=k.length(g);if(h==0)g=[0,0,1];else k.scale(1/h);l.uniform3f(l.getUniformLocation(l.program,"u_light.half_vector"),g[0],g[1],g[2])};return true}})(ChemDoodle.math,ChemDoodle.structures,vec3);
(function(c,a){a.Material=function(k){var b=k.getUniformLocation(k.program,"u_material.ambient_color"),d=k.getUniformLocation(k.program,"u_material.diffuse_color"),e=k.getUniformLocation(k.program,"u_material.specular_color"),l=k.getUniformLocation(k.program,"u_material.shininess");this.setTempColors=function(g,h,f,j,n){if(!this.aCache||this.aCache!=h){this.aCache=h;h=c.getRGB(h,1);g.uniform3f(b,h[0],h[1],h[2])}if(f!=null&&(!this.dCache||this.dCache!=f)){this.dCache=f;h=c.getRGB(f,1);g.uniform3f(d,
h[0],h[1],h[2])}if(!this.sCache||this.sCache!=j){this.sCache=j;h=c.getRGB(j,1);g.uniform3f(e,h[0],h[1],h[2])}if(!this.snCache||this.snCache!=n){this.snCache=n;g.uniform1f(l,n)}};this.setDiffuseColor=function(g,h){if(!this.dCache||this.dCache!=h){this.dCache=h;var f=c.getRGB(h,1);g.uniform3f(d,f[0],f[1],f[2])}};return true}})(ChemDoodle.math,ChemDoodle.structures);
(function(c,a){c.Shader=function(){this.init=function(k){var b=this.getShader(k,"vertex-shader");if(b==null)b=this.loadDefaultVertexShader(k);var d=this.getShader(k,"fragment-shader");if(d==null)d=this.loadDefaultFragmentShader(k);k.attachShader(k.program,b);k.attachShader(k.program,d);k.linkProgram(k.program);k.getProgramParameter(k.program,k.LINK_STATUS)||alert("Could not initialize shaders: "+k.getProgramInfoLog(program));k.useProgram(k.program);this.vertexPositionAttribute=k.getAttribLocation(k.program,
"a_vertex_position");k.enableVertexAttribArray(this.vertexPositionAttribute);this.vertexNormalAttribute=k.getAttribLocation(k.program,"a_vertex_normal");k.enableVertexAttribArray(this.vertexNormalAttribute)};this.getShader=function(k,b){var d=a.getElementById(b);if(!d)return null;for(var e=[],l=d.firstChild;l;){l.nodeType==3&&e.push(l.textContent);l=l.nextSibling}if(d.type=="x-shader/x-fragment")l=k.createShader(k.FRAGMENT_SHADER);else if(d.type=="x-shader/x-vertex")l=k.createShader(k.VERTEX_SHADER);
else return null;k.shaderSource(l,e.join(""));k.compileShader(l);if(!k.getShaderParameter(l,k.COMPILE_STATUS)){alert(d.type+" "+k.getShaderInfoLog(l));return null}return l};this.loadDefaultVertexShader=function(k){var b=[];b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");
b.push("float shininess;");b.push("};");b.push("attribute vec3 a_vertex_position;");b.push("attribute vec3 a_vertex_normal;");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("uniform mat4 u_model_view_matrix;");b.push("uniform mat4 u_projection_matrix;");b.push("uniform mat3 u_normal_matrix;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");
b.push("if(length(a_vertex_normal)==0.0){");b.push("v_normal = a_vertex_normal;");b.push("}else{");b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);");b.push("}");b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);");b.push("v_light_direction = u_light.direction;");b.push("v_ambient = vec4(u_material.ambient_color, 1.0);");b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;");b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);");
b.push("}");var d=k.createShader(k.VERTEX_SHADER);k.shaderSource(d,b.join(""));k.compileShader(d);if(!k.getShaderParameter(d,k.COMPILE_STATUS)){alert("Vertex shader failed to compile: "+k.getShaderInfoLog(d));return null}return d};this.loadDefaultFragmentShader=function(k){var b=[];b.push("precision mediump float;\n");b.push("struct Light");b.push("{");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("vec3 direction;");b.push("vec3 half_vector;");b.push("};");b.push("struct Material");
b.push("{");b.push("vec3 ambient_color;");b.push("vec3 diffuse_color;");b.push("vec3 specular_color;");b.push("float shininess;");b.push("};");b.push("uniform Light u_light;");b.push("uniform Material u_material;");b.push("varying vec4 v_diffuse;");b.push("varying vec4 v_ambient;");b.push("varying vec3 v_normal;");b.push("varying vec3 v_light_direction;");b.push("void main(void)");b.push("{");b.push("if(length(v_normal)==0.0){");b.push("gl_FragColor = vec4(v_diffuse.rgba);");b.push("}else{");b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);");
b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);");b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);");b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);");b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);");b.push("gl_FragColor = color+v_ambient;");b.push("}");b.push("}");var d=k.createShader(k.FRAGMENT_SHADER);k.shaderSource(d,b.join(""));k.compileShader(d);if(!k.getShaderParameter(d,k.COMPILE_STATUS)){alert("Fragment shader failed to compile: "+
k.getShaderInfoLog(d));return null}return d};return true}})(ChemDoodle.structures,document);
(function(c,a){c.Shape=function(k,b,d){for(var e=b.length,l=[],g=[],h=new c.Point,f=0,j=e;f<j;f++){var n=f+1;if(f==j-1)n=0;var p=b[f];n=b[n];for(var q=a.cross([0,0,1],[n.x-p.x,n.y-p.y,0]),m=0;m<2;m++){l.push(p.x,p.y,d/2);l.push(p.x,p.y,-d/2);l.push(n.x,n.y,d/2);l.push(n.x,n.y,-d/2)}for(m=0;m<4;m++)g.push(q[0],q[1],q[2]);g.push(0,0,1);g.push(0,0,-1);g.push(0,0,1);g.push(0,0,-1);h.add(p)}h.x/=e;h.y/=e;g.push(0,0,1);l.push(h.x,h.y,d/2);g.push(0,0,-1);l.push(h.x,h.y,-d/2);b=[];d=e*8;f=0;for(j=e;f<j;f++){e=
f*8;b.push(e);b.push(e+1);b.push(e+3);b.push(e);b.push(e+2);b.push(e+3);b.push(e+4);b.push(e+6);b.push(d);b.push(e+5);b.push(e+7);b.push(d+1)}this.setupBuffers(k,l,g,b);return true};c.Shape.prototype=new c._Mesh})(ChemDoodle.structures,vec3);
(function(c,a,k,b,d,e){var l=function(g,h,f){var j=b.sqrt(h[1]*h[1]+h[2]*h[2]),n=[1,0,0,0,0,h[2]/j,-h[1]/j,0,0,h[1]/j,h[2]/j,0,0,0,0,1],p=[1,0,0,0,0,h[2]/j,h[1]/j,0,0,-h[1]/j,h[2]/j,0,0,0,0,1],q=[j,0,-h[0],0,0,1,0,0,h[0],0,j,0,0,0,0,1];h=[j,0,h[0],0,0,1,0,0,-h[0],0,j,0,0,0,0,1];f=[b.cos(f),-b.sin(f),0,0,b.sin(f),b.cos(f),0,0,0,0,1,0,0,0,0,1];var m=d.multiply(n,d.multiply(q,d.multiply(f,d.multiply(h,p,[]))));this.rotate=function(){return d.multiplyVec3(m,g)}};k.Tube=function(g,h,f,j){var n=h[0].lineSegments[0].length,
p=[],q=[];this.ends=[];this.ends.push(h[0].lineSegments[0][0]);this.ends.push(h[h.length-2].lineSegments[0][0]);for(var m=[1,0,0],t=0,v=h.length-1;t<v;t++)for(var r=h[t],w=Infinity,u=new k.Atom("",h[t+1].cp1.x,h[t+1].cp1.y,h[t+1].cp1.z),x=0;x<n;x++){var z=r.lineSegments[0][x],A=null;A=x==n-1?t==h.length-2?r.lineSegments[0][x-1]:h[t+1].lineSegments[0][0]:r.lineSegments[0][x+1];A=[A.x-z.x,A.y-z.y,A.z-z.z];e.normalize(A);t==h.length-2&&x==n-1&&e.scale(A,-1);var B=vec3.cross(A,m,[]);e.normalize(B);e.scale(B,
f/2);B=new l(B,A,2*Math.PI/j);A=0;for(var F=j;A<F;A++){var G=B.rotate();if(A==b.floor(j/4))m=[G[0],G[1],G[2]];q.push(G[0],G[1],G[2]);p.push(z.x+G[0],z.y+G[1],z.z+G[2])}if(u!=null){A=z.distance3D(u);if(A<w){w=A;h[t+1].pPoint=z}}}m=[];t=0;for(v=h.length-2;t<v;t++){r=t*n*j;x=0;for(w=n;x<w;x++){u=r+x*j;for(A=0;A<j;A++){if(A==j-1)nextRes=t==h.length-2?0:-A;z=u+A;m.push(z);m.push(z+j);m.push(z+j+1);m.push(z);m.push(z+1);m.push(z+j+1)}}}this.setupBuffers(g,p,q,m);j=[new k.Point(2,0)];for(t=0;t<60;t++){n=
t/60*b.PI;j.push(new k.Point(2*b.cos(n),-2*b.sin(n)))}j.push(new k.Point(-2,0),new k.Point(-2,4),new k.Point(2,4));var C=new k.Shape(g,j,1);this.render=function(D,E){this.bindBuffers();D.material.setDiffuseColor(D,E.nucleics_tubeColor);D.drawElements(D.TRIANGLES,this.vertexIndexBuffer.numItems,D.UNSIGNED_SHORT,0);D.sphereBuffer.bindBuffers();for(var M=0;M<2;M++){var I=this.ends[M];I=d.translate(D.modelViewMatrix,[I.x,I.y,I.z],[]);var O=f/2;d.scale(I,[O,O,O]);D.setMatrixUniforms(I);D.drawElements(D.TRIANGLES,
D.sphereBuffer.vertexIndexBuffer.numItems,D.UNSIGNED_SHORT,0)}D.cylinderBuffer.bindBuffers();M=1;for(O=h.length-1;M<O;M++){var K=h[M],H=K.pPoint,J=new k.Atom("",K.cp2.x,K.cp2.y,K.cp2.z);I=1.001*H.distance3D(J);K=[f/4,I,f/4];I=d.translate(D.modelViewMatrix,[H.x,H.y,H.z],[]);var P=[0,1,0],L=0,Q=null,N=[J.x-H.x,J.y-H.y,J.z-H.z];if(H.x==J.x&&H.z==J.z){Q=[0,0,1];if(H.y<H.y)L=b.PI}else{L=c.vec3AngleFrom(P,N);Q=e.cross(P,N,[])}L!=0&&d.rotate(I,L,Q);d.scale(I,K);D.setMatrixUniforms(I);D.drawArrays(D.TRIANGLE_STRIP,
0,D.cylinderBuffer.vertexPositionBuffer.numItems)}C.bindBuffers();E.nucleics_useShapelyColors||D.material.setDiffuseColor(D,E.nucleics_baseColor);M=1;for(O=h.length-1;M<O;M++){K=h[M];J=K.cp2;I=d.translate(D.modelViewMatrix,[J.x,J.y,J.z],[]);P=[0,1,0];L=0;H=K.cp3;N=[H.x-J.x,H.y-J.y,H.z-J.z];if(J.x==H.x&&J.z==H.z){Q=[0,0,1];if(J.y<J.y)L=b.PI}else{L=c.vec3AngleFrom(P,N);Q=e.cross(P,N,[])}L!=0&&d.rotate(I,L,Q);J=[1,0,0];L=d.rotate(d.identity([]),L,Q);d.multiplyVec3(L,J);L=K.cp4;H=K.cp5;if(!(L.y==H.y&&
L.z==H.z)){L=[H.x-L.x,H.y-L.y,H.z-L.z];H=c.vec3AngleFrom(J,L);if(e.dot(N,e.cross(J,L))<0)H*=-1;d.rotateY(I,H)}if(E.nucleics_useShapelyColors)a[K.name]?D.material.setDiffuseColor(D,a[K.name].shapelyColor):D.material.setDiffuseColor(D,a["*"].shapelyColor);D.setMatrixUniforms(I);D.drawElements(D.TRIANGLES,C.vertexIndexBuffer.numItems,D.UNSIGNED_SHORT,0)}};return true};k.Tube.prototype=new k._Mesh})(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,Math,mat4,vec3);
(function(c){c.UnitCell=function(a,k){var b=[],d=[],e=function(h,f,j,n){b.push(h[0],h[1],h[2]);b.push(f[0],f[1],f[2]);b.push(j[0],j[1],j[2]);b.push(n[0],n[1],n[2]);for(h=0;h<4;h++)d.push(0,0,0)};e(k.o,k.x,k.xy,k.y);e(k.o,k.y,k.yz,k.z);e(k.o,k.z,k.xz,k.x);e(k.yz,k.y,k.xy,k.xyz);e(k.xyz,k.xz,k.z,k.yz);e(k.xy,k.x,k.xz,k.xyz);e=[];for(var l=0;l<6;l++){var g=l*4;e.push(g,g+1,g+1,g+2,g+2,g+3,g+3,g)}this.setupBuffers(a,b,d,e);return true};c.UnitCell.prototype=new c._Mesh})(ChemDoodle.structures,vec3);
(function(c,a,k){c.Plate=function(b){this.lanes=Array(b);i=0;for(ii=b;i<ii;i++)this.lanes[i]=[];this.sort=function(){i=0;for(ii=this.lanes.length;i<ii;i++)this.lanes[i].sort(function(d,e){return d-e})};this.draw=function(d){var e=d.canvas.width,l=d.canvas.height;this.origin=9*l/10;this.front=l/10;this.laneLength=this.origin-this.front;d.strokeStyle="#000000";d.beginPath();d.moveTo(0,this.front);a.contextHashTo(d,0,this.front,e,this.front,3,3);d.closePath();d.stroke();d.beginPath();d.moveTo(0,this.origin);
d.lineTo(e,this.origin);d.closePath();d.stroke();i=0;for(ii=this.lanes.length;i<ii;i++){l=(i+1)*e/(ii+1);d.beginPath();d.moveTo(l,this.origin);d.lineTo(l,this.origin+3);d.closePath();d.stroke();s=0;for(ss=this.lanes[i].length;s<ss;s++){var g=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case "compact":d.beginPath();d.arc(l,g,3,0,2*k.PI,false);d.closePath();break;case "expanded":d.beginPath();d.arc(l,g,7,0,2*k.PI,false);d.closePath();break;case "trailing":break;case "widened":a.contextOval(d,
l-18,g-10,36,10);break;case "cresent":d.beginPath();d.arc(l,g,9,0,k.PI,true);d.closePath();break}switch(this.lanes[i][s].style){case "solid":d.fillStyle="#000000";d.fill();break;case "transparent":d.stroke();break;case "gradient":break}}}};return true};c.Plate.Spot=function(b,d,e){this.type=b;this.rf=d;this.style=e?e:"solid"}})(ChemDoodle.structures,ChemDoodle.extensions,Math);
(function(c,a,k){c.default_backgroundColor="#FFFFFF";c.default_scale=1;c.default_rotateAngle=0;c.default_bondLength_2D=20;c.default_angstromsPerBondLength=1.25;c.default_lightDirection_3D=[-0.1,-0.1,-1];c.default_lightDiffuseColor_3D="#FFFFFF";c.default_lightSpecularColor_3D="#FFFFFF";c.default_projectionPerspective_3D=true;c.default_projectionPerspectiveVerticalFieldOfView_3D=45;c.default_projectionOrthoWidth_3D=40;c.default_projectionWidthHeightRatio_3D=1;c.default_projectionFrontCulling_3D=0.1;
c.default_projectionBackCulling_3D=1E4;c.default_atoms_display=true;c.default_atoms_color="#000000";c.default_atoms_font_size_2D=12;c.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"];c.default_atoms_font_bold_2D=false;c.default_atoms_font_italic_2D=false;c.default_atoms_circles_2D=false;c.default_atoms_circleDiameter_2D=10;c.default_atoms_circleBorderWidth_2D=1;c.default_atoms_useJMOLColors=false;c.default_atoms_resolution_3D=60;c.default_atoms_sphereDiameter_3D=0.8;c.default_atoms_useVDWDiameters_3D=
false;c.default_atoms_vdwMultiplier_3D=1;c.default_atoms_materialAmbientColor_3D="#000000";c.default_atoms_materialSpecularColor_3D="#555555";c.default_atoms_materialShininess_3D=32;c.default_atoms_implicitHydrogens_2D=true;c.default_atoms_displayTerminalCarbonLabels_2D=false;c.default_atoms_showHiddenCarbons_2D=true;c.default_bonds_display=true;c.default_bonds_color="#000000";c.default_bonds_width_2D=1;c.default_bonds_saturationWidth_2D=0.2;c.default_bonds_ends_2D="round";c.default_bonds_useJMOLColors=
false;c.default_bonds_colorGradient=false;c.default_bonds_saturationAngle_2D=k.PI/3;c.default_bonds_symmetrical_2D=false;c.default_bonds_clearOverlaps_2D=false;c.default_bonds_overlapClearWidth_2D=0.5;c.default_bonds_atomLabelBuffer_2D=0.25;c.default_bonds_wedgeThickness_2D=0.22;c.default_bonds_hashWidth_2D=1;c.default_bonds_hashSpacing_2D=2.5;c.default_bonds_showBondOrders_3D=false;c.default_bonds_resolution_3D=60;c.default_bonds_cylinderDiameter_3D=0.3;c.default_bonds_materialAmbientColor_3D="#222222";
c.default_bonds_materialSpecularColor_3D="#555555";c.default_bonds_materialShininess_3D=32;c.default_proteins_displayRibbon=true;c.default_proteins_ribbonCartoonize=false;c.default_proteins_useShapelyColors=false;c.default_proteins_useAminoColors=false;c.default_proteins_primaryColor="#FF0D0D";c.default_proteins_secondaryColor="#FFFF30";c.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740";c.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF";c.default_proteins_ribbonCartoonSheetColor=
"#E8BB99";c.default_proteins_ribbonThickness=0.2;c.default_proteins_materialAmbientColor_3D="#222222";c.default_proteins_materialSpecularColor_3D="#555555";c.default_proteins_materialShininess_3D=32;c.default_nucleics_display=true;c.default_nucleics_tubeColor="#CCCCCC";c.default_nucleics_baseColor="#C10000";c.default_nucleics_useShapelyColors=true;c.default_nucleics_tubeThickness=1.5;c.default_nucleics_tubeResolution_3D=60;c.default_nucleics_materialAmbientColor_3D="#222222";c.default_nucleics_materialSpecularColor_3D=
"#555555";c.default_nucleics_materialShininess_3D=32;c.default_macro_displayAtoms=false;c.default_macro_displayBonds=false;c.default_macro_atomToLigandDistance=-1;c.default_macro_showWater=false;c.default_crystals_displayUnitCell=true;c.default_crystals_unitCellColor="green";c.default_crystals_unitCellLineWidth=1;c.default_plots_color="#000000";c.default_plots_width=1;c.default_plots_showIntegration=false;c.default_plots_integrationColor="#c10000";c.default_plots_integrationLineWidth=1;c.default_plots_showGrid=
false;c.default_plots_gridColor="gray";c.default_plots_gridLineWidth=0.5;c.default_plots_showYAxis=true;c.default_plots_flipXAxis=false;c.default_text_font_size=12;c.default_text_font_families=["Helvetica","Arial","Dialog"];c.default_text_color="#000000";a.VisualSpecifications=function(){this.backgroundColor=c.default_backgroundColor;this.scale=c.default_scale;this.rotateAngle=c.default_rotateAngle;this.bondLength=c.default_bondLength_2D;this.angstromsPerBondLength=c.default_angstromsPerBondLength;
this.lightDirection_3D=c.default_lightDirection_3D;this.lightDiffuseColor_3D=c.default_lightDiffuseColor_3D;this.lightSpecularColor_3D=c.default_lightSpecularColor_3D;this.projectionPerspective_3D=c.default_projectionPerspective_3D;this.projectionPerspectiveVerticalFieldOfView_3D=c.default_projectionPerspectiveVerticalFieldOfView_3D;this.projectionOrthoWidth_3D=c.default_projectionOrthoWidth_3D;this.projectionWidthHeightRatio_3D=c.default_projectionWidthHeightRatio_3D;this.projectionFrontCulling_3D=
c.default_projectionFrontCulling_3D;this.projectionBackCulling_3D=c.default_projectionBackCulling_3D;this.atoms_display=c.default_atoms_display;this.atoms_color=c.default_atoms_color;this.atoms_font_size_2D=c.default_atoms_font_size_2D;this.atoms_font_families_2D=[];for(var b=0,d=c.default_atoms_font_families_2D.length;b<d;b++)this.atoms_font_families_2D[b]=c.default_atoms_font_families_2D[b];this.atoms_font_bold_2D=c.default_atoms_font_bold_2D;this.atoms_font_italic_2D=c.default_atoms_font_italic_2D;
this.atoms_circles_2D=c.default_atoms_circles_2D;this.atoms_circleDiameter_2D=c.default_atoms_circleDiameter_2D;this.atoms_circleBorderWidth_2D=c.default_atoms_circleBorderWidth_2D;this.atoms_useJMOLColors=c.default_atoms_useJMOLColors;this.atoms_resolution_3D=c.default_atoms_resolution_3D;this.atoms_sphereDiameter_3D=c.default_atoms_sphereDiameter_3D;this.atoms_useVDWDiameters_3D=c.default_atoms_useVDWDiameters_3D;this.atoms_vdwMultiplier_3D=c.default_atoms_vdwMultiplier_3D;this.atoms_materialAmbientColor_3D=
c.default_atoms_materialAmbientColor_3D;this.atoms_materialSpecularColor_3D=c.default_atoms_materialSpecularColor_3D;this.atoms_materialShininess_3D=c.default_atoms_materialShininess_3D;this.atoms_implicitHydrogens_2D=c.default_atoms_implicitHydrogens_2D;this.atoms_displayTerminalCarbonLabels_2D=c.default_atoms_displayTerminalCarbonLabels_2D;this.atoms_showHiddenCarbons_2D=c.default_atoms_showHiddenCarbons_2D;this.bonds_display=c.default_bonds_display;this.bonds_color=c.default_bonds_color;this.bonds_width_2D=
c.default_bonds_width_2D;this.bonds_saturationWidth_2D=c.default_bonds_saturationWidth_2D;this.bonds_ends_2D=c.default_bonds_ends_2D;this.bonds_useJMOLColors=c.default_bonds_useJMOLColors;this.bonds_colorGradient=c.default_bonds_colorGradient;this.bonds_saturationAngle_2D=c.default_bonds_saturationAngle_2D;this.bonds_symmetrical_2D=c.default_bonds_symmetrical_2D;this.bonds_clearOverlaps_2D=c.default_bonds_clearOverlaps_2D;this.bonds_overlapClearWidth_2D=c.default_bonds_overlapClearWidth_2D;this.bonds_atomLabelBuffer_2D=
c.default_bonds_atomLabelBuffer_2D;this.bonds_wedgeThickness_2D=c.default_bonds_wedgeThickness_2D;this.bonds_hashWidth_2D=c.default_bonds_hashWidth_2D;this.bonds_hashSpacing_2D=c.default_bonds_hashSpacing_2D;this.bonds_showBondOrders_3D=c.default_bonds_showBondOrders_3D;this.bonds_resolution_3D=c.default_bonds_resolution_3D;this.bonds_cylinderDiameter_3D=c.default_bonds_cylinderDiameter_3D;this.bonds_materialAmbientColor_3D=c.default_bonds_materialAmbientColor_3D;this.bonds_materialSpecularColor_3D=
c.default_bonds_materialSpecularColor_3D;this.bonds_materialShininess_3D=c.default_bonds_materialShininess_3D;this.proteins_displayRibbon=c.default_proteins_displayRibbon;this.proteins_ribbonCartoonize=c.default_proteins_ribbonCartoonize;this.proteins_useShapelyColors=c.default_proteins_useShapelyColors;this.proteins_useAminoColors=c.default_proteins_useAminoColors;this.proteins_primaryColor=c.default_proteins_primaryColor;this.proteins_secondaryColor=c.default_proteins_secondaryColor;this.proteins_ribbonCartoonHelixPrimaryColor=
c.default_proteins_ribbonCartoonHelixPrimaryColor;this.proteins_ribbonCartoonHelixSecondaryColor=c.default_proteins_ribbonCartoonHelixSecondaryColor;this.proteins_ribbonCartoonSheetColor=c.default_proteins_ribbonCartoonSheetColor;this.proteins_ribbonThickness=c.default_proteins_ribbonThickness;this.proteins_materialAmbientColor_3D=c.default_proteins_materialAmbientColor_3D;this.proteins_materialSpecularColor_3D=c.default_proteins_materialSpecularColor_3D;this.proteins_materialShininess_3D=c.default_proteins_materialShininess_3D;
this.macro_displayAtoms=c.default_macro_displayAtoms;this.macro_displayBonds=c.default_macro_displayBonds;this.macro_atomToLigandDistance=c.default_macro_atomToLigandDistance;this.nucleics_display=c.default_nucleics_display;this.nucleics_tubeColor=c.default_nucleics_tubeColor;this.nucleics_baseColor=c.default_nucleics_baseColor;this.nucleics_useShapelyColors=c.default_nucleics_useShapelyColors;this.nucleics_tubeThickness=c.default_nucleics_tubeThickness;this.nucleics_tubeResolution_3D=c.default_nucleics_tubeResolution_3D;
this.nucleics_materialAmbientColor_3D=c.default_nucleics_materialAmbientColor_3D;this.nucleics_materialSpecularColor_3D=c.default_nucleics_materialSpecularColor_3D;this.nucleics_materialShininess_3D=c.default_nucleics_materialShininess_3D;this.macro_showWater=c.default_macro_showWater;this.crystals_displayUnitCell=c.default_crystals_displayUnitCell;this.crystals_unitCellColor=c.default_crystals_unitCellColor;this.crystals_unitCellLineWidth=c.default_crystals_unitCellLineWidth;this.plots_color=c.default_plots_color;
this.plots_width=c.default_plots_width;this.plots_showIntegration=c.default_plots_showIntegration;this.plots_integrationColor=c.default_plots_integrationColor;this.plots_integrationLineWidth=c.default_plots_integrationLineWidth;this.plots_showGrid=c.default_plots_showGrid;this.plots_gridColor=c.default_plots_gridColor;this.plots_gridLineWidth=c.default_plots_gridLineWidth;this.plots_showYAxis=c.default_plots_showYAxis;this.plots_flipXAxis=c.default_plots_flipXAxis;this.text_font_size=c.default_text_font_size;
this.text_font_families=[];b=0;for(d=c.default_text_font_families.length;b<d;b++)this.text_font_families[b]=c.default_text_font_families[b];this.text_color=c.default_text_color;this.set3DRepresentation=function(e){this.bonds_display=this.atoms_display=true;this.bonds_color="#777777";this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=true;if(e=="Ball and Stick"){this.atoms_vdwMultiplier_3D=0.3;this.bonds_useJMOLColors=false;this.bonds_cylinderDiameter_3D=
0.3;this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D}else if(e=="van der Waals Spheres"){this.bonds_display=false;this.atoms_vdwMultiplier_3D=1}else if(e=="Stick"){this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=0.8;this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D}else if(e=="Wireframe"){this.atoms_useVDWDiameters_3D=false;this.bonds_cylinderDiameter_3D=0.05;this.atoms_sphereDiameter_3D=
0.15;this.bonds_materialAmbientColor_3D=c.default_atoms_materialAmbientColor_3D}else alert('"'+e+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n')};this.getFontString=function(e,l,g,h){var f=[];g&&f.push("bold ");h&&f.push("italic ");f.push(e+"px ");e=0;for(g=l.length;e<g;e++){h=l[e];if(h.indexOf(" ")!=-1)h='"'+h+'"';f.push((e!=0?",":"")+h)}return f.join("")}}})(ChemDoodle,ChemDoodle.structures,Math);
(function(c,a,k,b){k.getPointsPerAngstrom=function(){return c.default_bondLength_2D/c.default_angstromsPerBondLength};k.BondDeducer=function(){this.margin=1.1;this.deduceCovalentBonds=function(d,e){var l=k.getPointsPerAngstrom();if(e)l=e;for(var g=0,h=d.atoms.length;g<h;g++)for(var f=g+1;f<h;f++){var j=d.atoms[g],n=d.atoms[f];j.distance3D(n)<(a[j.label].covalentRadius+a[n.label].covalentRadius)*l*this.margin&&d.bonds.push(new b.Bond(j,n,1))}};return true}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,
ChemDoodle.structures);(function(c){c.HydrogenDeducer=function(){this.removeHydrogens=function(a){for(var k=[],b=[],d=0,e=a.bonds.length;d<e;d++)a.bonds[d].a1.label!="H"&&a.bonds[d].a2.label!="H"&&b.push(a.bonds[d]);d=0;for(e=a.atoms.length;d<e;d++)a.atoms[d].label!="H"&&k.push(a.atoms[d]);a.atoms=k;a.bonds=b};return true}})(ChemDoodle.informatics);
(function(c,a){c.Splitter=function(){this.split=function(k){for(var b=[],d=0,e=k.atoms.length;d<e;d++)k.atoms[d].visited=false;d=0;for(e=k.bonds.length;d<e;d++)k.bonds[d].visited=false;d=0;for(e=k.atoms.length;d<e;d++){var l=k.atoms[d];if(!l.visited){var g=new a.Molecule;g.atoms.push(l);l.visited=true;var h=new a.Queue;for(h.enqueue(l);!h.isEmpty();){l=h.dequeue();for(var f=0,j=k.bonds.length;f<j;f++){var n=k.bonds[f];if(n.contains(l)&&!n.visited){n.visited=true;g.bonds.push(n);n=n.getNeighbor(l);
if(!n.visited){n.visited=true;g.atoms.push(n);h.enqueue(n)}}}}b.push(g)}}return b};return true}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(c,a){c.StructureBuilder=function(){this.copy=function(k){for(var b=0,d=k.atoms.length;b<d;b++)k.atoms[b].metaID=b;var e=new a.Molecule;b=0;for(d=k.atoms.length;b<d;b++)e.atoms[b]=new a.Atom(k.atoms[b].label,k.atoms[b].x,k.atoms[b].y,k.atoms[b].z);b=0;for(d=k.bonds.length;b<d;b++)e.bonds[b]=new a.Bond(e.atoms[k.bonds[b].a1.metaID],e.atoms[k.bonds[b].a2.metaID],k.bonds[b].bondOrder);return e};return true}})(ChemDoodle.informatics,ChemDoodle.structures);
(function(c){c._Counter=function(){this.value=0;this.molecule=null;this.setMolecule=function(a){this.value=0;this.molecule=a;this.innerCalculate&&this.innerCalculate()};return true}})(ChemDoodle.informatics);(function(c){c.FrerejacqueNumberCounter=function(a){this.setMolecule(a);return true};c.FrerejacqueNumberCounter.prototype=new c._Counter;c.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+(new c.NumberOfMoleculesCounter(this.molecule)).value}})(ChemDoodle.informatics);
(function(c,a){a.NumberOfMoleculesCounter=function(k){this.setMolecule(k);return true};a.NumberOfMoleculesCounter.prototype=new a._Counter;a.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var k=0,b=this.molecule.atoms.length;k<b;k++)this.molecule.atoms[k].visited=false;k=0;for(b=this.molecule.atoms.length;k<b;k++)if(!this.molecule.atoms[k].visited){this.value++;var d=new c.Queue;this.molecule.atoms[k].visited=true;for(d.enqueue(this.molecule.atoms[k]);!d.isEmpty();)for(var e=d.dequeue(),
l=0,g=this.molecule.bonds.length;l<g;l++){var h=this.molecule.bonds[l];if(h.contains(e)){h=h.getNeighbor(e);if(!h.visited){h.visited=true;d.enqueue(h)}}}}}})(ChemDoodle.structures,ChemDoodle.informatics);
(function(c,a){c._RingFinder=function(){this.rings=this.bonds=this.atoms=null;this.reduce=function(k){for(var b=0,d=k.atoms.length;b<d;b++)k.atoms[b].visited=false;b=0;for(d=k.bonds.length;b<d;b++)k.bonds[b].visited=false;for(var e=true;e;){e=false;b=0;for(d=k.atoms.length;b<d;b++){for(var l=0,g=null,h=0,f=k.bonds.length;h<f;h++)if(k.bonds[h].contains(k.atoms[b])&&!k.bonds[h].visited){l++;if(l==2)break;g=k.bonds[h]}if(l==1){e=true;g.visited=true;k.atoms[b].visited=true}}}b=0;for(d=k.atoms.length;b<
d;b++)k.atoms[b].visited||this.atoms.push(k.atoms[b]);b=0;for(d=k.bonds.length;b<d;b++)k.bonds[b].visited||this.bonds.push(k.bonds[b]);if(this.bonds.length==0&&this.atoms.length!=0)this.atoms=[]};this.setMolecule=function(k){this.atoms=[];this.bonds=[];this.rings=[];this.reduce(k);this.atoms.length>2&&this.innerGetRings&&this.innerGetRings()};this.fuse=function(){for(var k=0,b=this.rings.length;k<b;k++)for(var d=0,e=this.bonds.length;d<e;d++)a(this.bonds[d].a1,this.rings[k].atoms)!=-1&&a(this.bonds[d].a2,
this.rings[k].atoms)!=-1&&this.rings[k].bonds.push(this.bonds[d])};return true}})(ChemDoodle.informatics,jQuery.inArray);
(function(c,a,k){function b(d,e){this.atoms=[];if(e)for(var l=0,g=e.atoms.length;l<g;l++)this.atoms[l]=e.atoms[l];this.atoms.push(d);this.grow=function(h,f){for(var j=this.atoms[this.atoms.length-1],n=[],p=0,q=h.length;p<q;p++)if(h[p].contains(j)){var m=h[p].getNeighbor(j);k(m,f)==-1&&n.push(m)}j=[];p=0;for(q=n.length;p<q;p++)j.push(new b(n[p],this));return j};this.check=function(h,f,j){for(var n=0,p=f.atoms.length-1;n<p;n++)if(k(f.atoms[n],this.atoms)!=-1)return null;var q=null;if(f.atoms[f.atoms.length-
1]==this.atoms[this.atoms.length-1]){q=new a.Ring;q.atoms[0]=j;n=0;for(p=this.atoms.length;n<p;n++)q.atoms.push(this.atoms[n]);for(n=f.atoms.length-2;n>=0;n--)q.atoms.push(f.atoms[n])}else{var m=[];n=0;for(p=h.length;n<p;n++)h[n].contains(f.atoms[f.atoms.length-1])&&m.push(h[n]);n=0;for(p=m.length;n<p;n++)if((f.atoms.length==1||!m[n].contains(f.atoms[f.atoms.length-2]))&&m[n].contains(this.atoms[this.atoms.length-1])){q=new a.Ring;q.atoms[0]=j;h=0;for(j=this.atoms.length;h<j;h++)q.atoms.push(this.atoms[h]);
for(h=f.atoms.length-1;h>=0;h--)q.atoms.push(f.atoms[h]);break}}return q};return true}c.EulerFacetRingFinder=function(d){this.fingerBreak=5;this.setMolecule(d);return true};c.EulerFacetRingFinder.prototype=new c._RingFinder;c.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var d=0,e=this.atoms.length;d<e;d++){for(var l=[],g=0,h=this.bonds.length;g<h;g++)this.bonds[g].contains(this.atoms[d])&&l.push(this.bonds[g].getNeighbor(this.atoms[d]));g=0;for(h=l.length;g<h;g++)for(var f=g+1;f<l.length;f++){var j=
[];j[0]=new b(l[g]);j[1]=new b(l[f]);var n=[];n[0]=this.atoms[d];for(var p=0,q=l.length;p<q;p++)p!=g&&p!=f&&n.push(l[p]);var m=[];if(p=j[0].check(this.bonds,j[1],this.atoms[d]))m[0]=p;for(;m.length==0&&j.length>0&&j[0].atoms.length<this.fingerBreak;){var t=[];p=0;for(q=j.length;p<q;p++)for(var v=j[p].grow(this.bonds,n),r=0,w=v.length;r<w;r++)t.push(v[r]);j=t;p=0;for(q=j.length;p<q;p++)for(r=p+1;r<q;r++)(w=j[p].check(this.bonds,j[r],this.atoms[d]))&&m.push(w);if(m.length==0){t=[];p=0;for(q=n.length;p<
q;p++){r=0;for(w=this.bonds.length;r<w;r++)if(this.bonds[r].contains(n[p])){l=this.bonds[r].getNeighbor(n[p]);k(l,n)==-1&&k(l,t)==-1&&t.push(l)}}p=0;for(q=t.length;p<q;p++)n.push(t[p])}}if(m.length>0){j=null;p=0;for(q=m.length;p<q;p++)if(!j||j.atoms.length>m[p].atoms.length)j=m[p];m=false;p=0;for(q=this.rings.length;p<q;p++){n=true;r=0;for(w=j.atoms.length;r<w;r++)if(k(j.atoms[r],this.rings[p].atoms)==-1){n=false;break}if(n){m=true;break}}m||this.rings.push(j)}}}this.fuse()}})(ChemDoodle.informatics,
ChemDoodle.structures,jQuery.inArray);
(function(c){c.SSSRFinder=function(a){this.rings=[];if(a.atoms.length>0){var k=(new c.FrerejacqueNumberCounter(a)).value,b=(new c.EulerFacetRingFinder(a)).rings;b.sort(function(h,f){return h.atoms.length-f.atoms.length});for(var d=0,e=a.bonds.length;d<e;d++)a.bonds[d].visited=false;d=0;for(e=b.length;d<e;d++){a=false;for(var l=0,g=b[d].bonds.length;l<g;l++)if(!b[d].bonds[l].visited){a=true;break}if(a){l=0;for(g=b[d].bonds.length;l<g;l++)b[d].bonds[l].visited=true;this.rings.push(b[d])}if(this.rings.length==
k)break}}return true}})(ChemDoodle.informatics);
(function(c,a,k,b,d,e){var l=/\s+/g,g=/\(|\)|\s+/g,h=/\'|\s+/g,f=/,|\'|\s+/g,j=/[0-9]/,n={P:[],A:[[0,0.5,0.5]],B:[[0.5,0,0.5]],C:[[0.5,0.5,0]],I:[[0.5,0.5,0.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,0.5,0.5],[0.5,0,0.5],[0.5,0.5,0]]},p=function(m){var t=0,v=0,r=0,w=0,u=m.indexOf("x"),x=m.indexOf("y"),z=m.indexOf("z");if(u!=-1){v++;if(u>0&&m.charAt(u-1)!="+")v*=-1}if(x!=-1){r++;if(x>0&&m.charAt(x-1)!="+")r*=-1}if(z!=-1){w++;if(z>0&&m.charAt(z-
1)!="+")w*=-1}if(m.length>2){u="+";x=0;for(z=m.length;x<z;x++){var A=m.charAt(x);if((A=="-"||A=="/")&&(x==m.length-1||m.charAt(x+1).match(j)))u=A;if(A.match(j))if(u=="+")t+=parseInt(A);else if(u=="-")t-=parseInt(A);else if(u=="/")t/=parseInt(A)}}return[t,v,r,w]};k.CIFInterpreter=function(){this.read=function(m,t,v,r){t=t?t:1;v=v?v:1;r=r?r:1;var w=new b.Molecule;if(m==null||m.length==0)return w;for(var u=m.split("\n"),x=0,z=0,A=0,B=m=0,F=0,G="P",C=null;!a.stringStartsWith(C=u.shift(),"loop_");)if(C.length>
0)if(a.stringStartsWith(C,"_cell_length_a"))x=parseFloat(C.split(g)[1]);else if(a.stringStartsWith(C,"_cell_length_b"))z=parseFloat(C.split(g)[1]);else if(a.stringStartsWith(C,"_cell_length_c"))A=parseFloat(C.split(g)[1]);else if(a.stringStartsWith(C,"_cell_angle_alpha"))m=d.PI*parseFloat(C.split(g)[1])/180;else if(a.stringStartsWith(C,"_cell_angle_beta"))B=d.PI*parseFloat(C.split(g)[1])/180;else if(a.stringStartsWith(C,"_cell_angle_gamma"))F=d.PI*parseFloat(C.split(g)[1])/180;else if(a.stringStartsWith(C,
"_symmetry_space_group_name_H-M"))G=C.split(h)[1];x=x;C=z;A=A;B=B;F=F;m=(d.cos(m)-d.cos(F)*d.cos(B))/d.sin(F);m=[x,0,0,0,C*d.cos(F),C*d.sin(F),0,0,A*d.cos(B),A*m,A*d.sqrt(1-d.pow(d.cos(B),2)-d.pow(m,2)),0,0,0,0,1];for(B=[];!a.stringStartsWith(C=u.shift(),"loop_");)C.length>0&&a.stringStartsWith(C,"'")&&B.push(C);for(;a.stringStartsWith(u[0],"_");)u.shift();F=0;for(x=u.length;F<x;F++){C=u[F];if(C.length==0)break;C=C.split(l);w.atoms.push(new b.Atom(C[2],parseFloat(C[3]),parseFloat(C[4]),parseFloat(C[5])))}var D=
n[G];C=[];F=0;for(x=B.length;F<x;F++){u=B[F].split(f);var E=p(u[1]),M=p(u[2]),I=p(u[3]);G=0;for(z=w.atoms.length;G<z;G++){u=w.atoms[G];var O=u.x*E[1]+u.y*E[2]+u.z*E[3]+E[0],K=u.x*M[1]+u.y*M[2]+u.z*M[3]+M[0],H=u.x*I[1]+u.y*I[2]+u.z*I[3]+I[0];C.push(new b.Atom(u.label,O,K,H));if(D){A=0;for(var J=D.length;A<J;A++){var P=D[A];C.push(new b.Atom(u.label,O+P[0],K+P[1],H+P[2]))}}}}F=0;for(x=C.length;F<x;F++){for(u=C[F];u.x>=1;)u.x--;for(;u.x<0;)u.x++;for(;u.y>=1;)u.y--;for(;u.y<0;)u.y++;for(;u.z>=1;)u.z--;
for(;u.z<0;)u.z++}B=[];F=0;for(x=C.length;F<x;F++){A=false;u=C[F];G=0;for(z=w.atoms.length;G<z;G++)if(w.atoms[G].distance3D(u)<1.0E-4){A=true;break}if(!A){G=0;for(z=B.length;G<z;G++)if(B[G].distance3D(u)<1.0E-4){A=true;break}A||B.push(u)}}w.atoms=w.atoms.concat(B);x=[];for(F=0;F<t;F++)for(G=0;G<v;G++)for(A=0;A<r;A++)if(!(F==0&&G==0&&A==0)){B=0;for(C=w.atoms.length;B<C;B++){u=w.atoms[B];x.push(new b.Atom(u.label,u.x+F,u.y+G,u.z+A))}}w.atoms=w.atoms.concat(x);F=0;for(x=w.atoms.length;F<x;F++){u=w.atoms[F];
B=e.multiplyVec3(m,[u.x,u.y,u.z]);u.x=B[0];u.y=B[1];u.z=B[2]}(new c.informatics.BondDeducer).deduceCovalentBonds(w,1);t=[-t/2,-v/2,-r/2];w.unitCellVectors={o:e.multiplyVec3(m,t,[]),x:e.multiplyVec3(m,[t[0]+1,t[1],t[2]]),y:e.multiplyVec3(m,[t[0],t[1]+1,t[2]]),z:e.multiplyVec3(m,[t[0],t[1],t[2]+1]),xy:e.multiplyVec3(m,[t[0]+1,t[1]+1,t[2]]),xz:e.multiplyVec3(m,[t[0]+1,t[1],t[2]+1]),yz:e.multiplyVec3(m,[t[0],t[1]+1,t[2]+1]),xyz:e.multiplyVec3(m,[t[0]+1,t[1]+1,t[2]+1])};return w}};var q=new k.CIFInterpreter;
c.readCIF=function(m,t,v,r){return q.read(m,t,v,r)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3);
(function(c,a,k,b,d){function e(g,h,f){for(var j=g.length,n="",p=0;p<h-j;p++)n+=" ";return f?g+n:n+g}k.MOLInterpreter=function(){this.read=function(g,h){if(!h)h=c.default_bondLength_2D;var f=new b.Molecule;if(g==null||g.length==0)return f;var j=g.split("\n"),n=j[3],p=parseInt(n.substring(0,3));n=parseInt(n.substring(3,6));for(var q=0;q<p;q++){var m=j[4+q];f.atoms[q]=new b.Atom(m.substring(31,34),parseFloat(m.substring(0,10))*h,(h==1?1:-1)*parseFloat(m.substring(10,20))*h,parseFloat(m.substring(20,
30))*h);var t=parseInt(m.substring(34,36));if(t!=0&&a[f.atoms[q].label]!=null)f.atoms[q].mass=a[f.atoms[q].label].mass+t;switch(parseInt(m.substring(36,39))){case 1:f.atoms[q].charge=3;break;case 2:f.atoms[q].charge=2;break;case 3:f.atoms[q].charge=1;break;case 5:f.atoms[q].charge=-1;break;case 6:f.atoms[q].charge=-2;break;case 7:f.atoms[q].charge=-3;break}}for(q=0;q<n;q++){m=j[4+p+q];var v=parseInt(m.substring(6,9));t=parseInt(m.substring(9,12));if(v>3)switch(v){case 4:v=1.5;break;default:v=1;break}m=
new b.Bond(f.atoms[parseInt(m.substring(0,3))-1],f.atoms[parseInt(m.substring(3,6))-1],v);switch(t){case 3:m.stereo=b.Bond.STEREO_AMBIGUOUS;break;case 1:m.stereo=b.Bond.STEREO_PROTRUDING;break;case 6:m.stereo=b.Bond.STEREO_RECESSED;break}f.bonds[q]=m}return f};this.write=function(g){var h="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n";h=h+e(g.atoms.length.toString(),3)+e(g.bonds.length.toString(),3)+"  0  0  0  0            999 v2000\n";for(var f=g.getCenter(),j=0,n=g.atoms.length;j<
n;j++){var p=g.atoms[j],q=" 0";if(p.mass!=-1&&a[p.label]!=null){var m=p.mass-a[p.label].mass;if(m<5&&m>-4)q=(m>-1?" ":"")+m}m="  0";if(p.charge!=0)switch(p.charge){case 3:m="  1";break;case 2:m="  2";break;case 1:m="  3";break;case -1:m="  5";break;case -2:m="  6";break;case -3:m="  7";break}h=h+e(((p.x-f.x)/c.default_bondLength_2D).toFixed(4),10)+e((-(p.y-f.y)/c.default_bondLength_2D).toFixed(4),10)+e((p.z/c.default_bondLength_2D).toFixed(4),10)+" "+e(p.label,3,true)+q+m+"  0  0  0  0\n"}j=0;for(n=
g.bonds.length;j<n;j++){f=g.bonds[j];p=0;if(f.stereo==b.Bond.STEREO_AMBIGUOUS)p=3;else if(f.stereo==b.Bond.STEREO_PROTRUDING)p=1;else if(f.stereo==b.Bond.STEREO_RECESSED)p=6;h=h+e((d(f.a1,g.atoms)+1).toString(),3)+e((d(f.a2,g.atoms)+1).toString(),3)+e(f.bondOrder.toString(),3)+"  "+p+"     0  0\n"}h+="M  END";return h}};var l=new k.MOLInterpreter;c.readMOL=function(g,h){return l.read(g,h)};c.writeMOL=function(g){return l.write(g)}})(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,
jQuery.inArray);
(function(c,a,k,b,d){k.PDBInterpreter=function(){function l(g,h,f,j,n){for(var p=0,q=h.length;p<q;p++){var m=h[p];if(m.id==f&&j>=m.start&&j<=m.end){if(n)g.helix=true;else g.sheet=true;if(j+1==m.end)g.arrow=true;return}}}this.calculateRibbonDistances=false;this.read=function(g,h){var f=new b.Molecule;f.chains=[];if(g==null||g.length==0)return f;var j=g.split("\n");h||(h=1);for(var n=[],p=[],q=null,m=[],t=0,v=j.length;t<v;t++){var r=j[t];if(a.stringStartsWith(r,"HELIX"))n.push({id:r.substring(19,20),
start:parseInt(r.substring(21,25)),end:parseInt(r.substring(33,37))});else if(a.stringStartsWith(r,"SHEET"))p.push({id:r.substring(21,22),start:parseInt(r.substring(22,26)),end:parseInt(r.substring(33,37))});else if(a.stringStartsWith(r,"ATOM")){var w=r.substring(16,17);if(w==" "||w=="A"){w=d(r.substring(76,78));if(w.length==0){var u=d(r.substring(12,14));if(u=="HD")w="H";else if(u.length>0)w=u.length>1?u.charAt(0)+u.substring(1).toLowerCase():u}w=new b.Atom(w,parseFloat(r.substring(30,38))*h,parseFloat(r.substring(38,
46))*h,parseFloat(r.substring(46,54))*h);w.hetatm=false;f.atoms.push(w);u=parseInt(r.substring(22,26));if(m.length==0)for(var x=0;x<2;x++){var z=new b.Residue(-1);z.cp1=w;z.cp2=w;m.push(z)}if(u!=Number.NaN&&m[m.length-1].resSeq!=u){x=new b.Residue(u);x.name=d(r.substring(17,20));if(x.name.length==3)x.name=x.name.substring(0,1)+x.name.substring(1).toLowerCase();else if(x.name.length==2&&x.name.charAt(0)=="D")x.name=x.name.substring(1);m.push(x);z=r.substring(21,22);l(x,n,z,u,true);l(x,p,z,u,false)}r=
d(r.substring(12,16));u=m[m.length-1];if(r=="CA"||r=="P"||r=="O5'"){if(!u.cp1)u.cp1=w}else if(r=="N3"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="N1"&&(u.name=="A"||u.name=="G"))u.cp3=w;else if(r=="C2")u.cp4=w;else if(r=="C4"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="C6"&&(u.name=="A"||u.name=="G"))u.cp5=w;else if(r=="O"||r=="C6"&&(u.name=="C"||u.name=="U"||u.name=="T")||r=="N9"){if(!m[m.length-1].cp2){if(r=="C6"||r=="N9")q=w;u.cp2=w}}else if(r=="C")q=w}}else if(a.stringStartsWith(r,"HETATM")){w=
d(r.substring(76,78));if(w.length>1)w=w.substring(0,1)+w.substring(1).toLowerCase();w=new b.Atom(w,parseFloat(r.substring(30,38))*h,parseFloat(r.substring(38,46))*h,parseFloat(r.substring(46,54))*h);w.hetatm=true;if(d(r.substring(17,20))=="HOH")w.isWater=true;f.atoms.push(w)}else if(a.stringStartsWith(r,"TER")){this.endChain(f,m,q);m=[]}else if(a.stringStartsWith(r,"ENDMDL"))break}this.endChain(f,m,q);(new c.informatics.BondDeducer).deduceCovalentBonds(f,h);this.calculateRibbonDistances&&this.calculateDistances(f);
return f};this.endChain=function(g,h,f){if(h.length>0){var j=h[h.length-1];if(!j.cp1)j.cp1=g.atoms[g.atoms.length-2];if(!j.cp2)j.cp2=g.atoms[g.atoms.length-1];for(j=0;j<4;j++){var n=new b.Residue(-1);n.cp1=f;n.cp2=h[h.length-1].cp2;h.push(n)}g.chains.push(h)}};this.calculateDistances=function(g){for(var h=[],f=[],j=0,n=g.atoms.length;j<n;j++){var p=g.atoms[j];if(p.hetatm)p.isWater||h.push(p);else f.push(p)}j=0;for(n=f.length;j<n;j++){p=f[j];p.closestDistance=Number.POSITIVE_INFINITY;if(h.length==
0)p.closestDistance=0;else{g=0;for(var q=h.length;g<q;g++)p.closestDistance=Math.min(p.closestDistance,p.distance3D(h[g]))}}}};var e=new k.PDBInterpreter;c.readPDB=function(l,g){return e.read(l,g)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery.trim);
(function(c,a,k,b,d,e){var l={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},g={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},h={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};k.JCAMPInterpreter=function(){this.convertHZ2PPM=false;this.read=function(j){this.isBreak=function(R){return l[R]!=null||g[R]!=null||h[R]!=null||R==" "||R=="-"||R=="+"};this.getValue=function(R,X){var T=R.charAt(0),U=R.substring(1);if(l[T]!=null)return parseFloat(l[T]+
U);else if(g[T]!=null)return parseFloat(g[T]+U)+X;return parseFloat(U)};var n=new b.Spectrum;if(j==null||j.length==0)return n;j=j.split("\n");for(var p=[],q,m,t,v,r=1,w=1,u=1,x=-1,z=-1,A=-1,B=true,F=false,G=0,C=j.length;G<C;G++){var D=e(j[G]),E=d.inArray("$$",D);if(E!=-1)D=D.substring(0,E);if(p.length==0||!a.stringStartsWith(j[G],"##")){p.length!=0&&p.push("\n");p.push(e(D))}else{E=p.join("");B&&E.length<100&&n.metadata.push(E);p=[D];if(a.stringStartsWith(E,"##TITLE="))n.title=e(E.substring(8));else if(a.stringStartsWith(E,
"##XUNITS=")){n.xUnit=e(E.substring(9));if(this.convertHZ2PPM&&n.xUnit.toUpperCase()=="HZ"){n.xUnit="PPM";F=true}}else if(a.stringStartsWith(E,"##YUNITS="))n.yUnit=e(E.substring(9));else if(!a.stringStartsWith(E,"##XYPAIRS="))if(a.stringStartsWith(E,"##FIRSTX="))m=parseFloat(e(E.substring(9)));else if(a.stringStartsWith(E,"##LASTX="))q=parseFloat(e(E.substring(8)));else if(a.stringStartsWith(E,"##FIRSTY="))t=parseFloat(e(E.substring(9)));else if(a.stringStartsWith(E,"##NPOINTS="))v=parseFloat(e(E.substring(10)));
else if(a.stringStartsWith(E,"##XFACTOR="))r=parseFloat(e(E.substring(10)));else if(a.stringStartsWith(E,"##YFACTOR="))w=parseFloat(e(E.substring(10)));else if(a.stringStartsWith(E,"##DELTAX="))x=parseFloat(e(E.substring(9)));else if(a.stringStartsWith(E,"##.OBSERVE FREQUENCY=")){if(this.convertHZ2PPM)u=parseFloat(e(E.substring(21)))}else if(a.stringStartsWith(E,"##.SHIFT REFERENCE=")){if(this.convertHZ2PPM){A=E.substring(19).split(",");z=parseInt(e(A[2]));A=parseFloat(e(A[3]))}}else if(a.stringStartsWith(E,
"##XYDATA=")){F||(u=1);D=B=false;E=E.split("\n");var M=(q-m)/(v-1);if(x!=-1)for(var I=1,O=E.length;I<O;I++)if(E[I].charAt(0)=="|"){M=x;break}var K=m-M,H=t,J=0,P;I=1;for(O=E.length;I<O;I++){var L=[];K=e(E[I]);p=[];for(var Q=false,N=0,S=K.length;N<S;N++)if(this.isBreak(K.charAt(N))){p.length>0&&!(p.length==1&&p[0]==" ")&&L.push(p.join(""));p=[K.charAt(N)]}else if(K.charAt(N)=="|")Q=true;else p.push(K.charAt(N));L.push(p.join(""));K=parseFloat(L[0])*r-M;N=1;for(S=L.length;N<S;N++){H=L[N];if(h[H.charAt(0)]!=
null)for(var Y=parseInt(h[H.charAt(0)]+H.substring(1))-1,W=0;W<Y;W++){K+=M;J=this.getValue(P,J);H=J*w;V++;n.data[n.data.length-1]=new b.Point(K/u,H)}else if(l[H.charAt(0)]!=null&&D){H=this.getValue(H,J)*w;if(Q){K+=M;n.data.push(new b.Point(K/u,H))}}else{D=g[H.charAt(0)]!=null;P=H;K+=M;J=this.getValue(H,J);H=J*w;V++;n.data.push(new b.Point(K/u,H))}}}if(z!=-1){D=A-n.data[z-1].x;G=0;for(C=n.data.length;G<C;G++)n.data[G].x+=D}}else if(a.stringStartsWith(E,"##PEAK TABLE=")){B=false;n.continuous=false;
E=E.split("\n");var V=0;I=1;for(O=E.length;I<O;I++){D=E[I].split(/[\s,]+/);V+=D.length/2;N=0;for(S=D.length;N+1<S;N+=2)n.data.push(new b.Point(parseFloat(e(D[N])),parseFloat(e(D[N+1]))))}}}}n.setup();return n}};var f=new k.JCAMPInterpreter;f.convertHZ2PPM=true;c.readJCAMP=function(j){return f.read(j)}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim);
(function(c,a,k){c.fromJSONChains=function(b){for(var d=[],e=0,l=b.cs.length;e<l;e++){for(var g=b.cs[e],h=[],f=0,j=g.length;f<j;f++){var n=g[f],p=new a.Residue;p.name=n.n;p.cp1=new a.Atom("",n.x1,n.y1,n.z1);p.cp2=new a.Atom("",n.x2,n.y2,n.z2);if(n.x3){p.cp3=new a.Atom("",n.x3,n.y3,n.z3);p.cp4=new a.Atom("",n.x4,n.y4,n.z4);p.cp5=new a.Atom("",n.x5,n.y5,n.z5)}p.helix=n.h;p.sheet=n.s;p.arrow=n.a;h.push(p)}d.push(h)}return d};c.fromJSONPDB=function(b){var d=c.fromJSONDummy(b.mol);d.findRings=false;d.fromJSON=
true;d.chains=c.fromJSONChains(b.ribbons);return d};c.fromJSONDummy=function(b){for(var d=new a.Molecule,e=0,l=b.a.length;e<l;e++){var g=b.a[e],h=new a.Atom(g.l?g.l:"C",g.x,g.y);if(g.z)h.z=g.z;if(g.c)h.charge=g.c;if(g.m)h.mass=g.m;if(g.p_h!=undefined)h.hetatm=g.p_h;if(g.p_w!=undefined)h.isWater=g.p_w;if(g.p_d!=undefined)h.closestDistance=g.p_d;d.atoms.push(h)}e=0;for(l=b.b.length;e<l;e++){g=b.b[e];h=new a.Bond(d.atoms[g.b],d.atoms[g.e],g.o?g.o:1);if(g.s)h.stereo=g.s;d.bonds.push(h)}return d};c.toJSONDummy=
function(b){for(var d={a:[],b:[]},e=0,l=b.atoms.length;e<l;e++){var g=b.atoms[e];d.a[e]={x:g.x,y:g.y};if(g.label!="C")d.a[e].l=g.label;if(g.z!=0)d.a[e].z=g.z;if(g.charge!=0)d.a[e].c=g.charge;if(g.mass!=-1)d.a[e].m=g.mass}e=0;for(l=b.bonds.length;e<l;e++){g=b.bonds[e];d.b[e]={b:k(g.a1,b.atoms),e:k(g.a2,b.atoms)};if(g.bondOrder!=1)d.b[e].o=g.bondOrder;if(g.stereo!=a.Bond.STEREO_NONE)d.b[e].s=g.stereo}return d}})(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray);
ChemDoodle.monitor=function(c,a){var k={};k.CANVAS_DRAGGING=null;k.CANVAS_OVER=null;k.ALT=false;k.SHIFT=false;k.META=false;c(a).ready(function(){c(a).mousemove(function(b){if(k.CANVAS_DRAGGING!=null)if(k.CANVAS_DRAGGING.drag){k.CANVAS_DRAGGING.prehandleEvent(b);k.CANVAS_DRAGGING.drag(b)}});c(a).mouseup(function(b){if(k.CANVAS_DRAGGING!=null&&k.CANVAS_DRAGGING!=k.CANVAS_OVER)if(k.CANVAS_DRAGGING.mouseup){k.CANVAS_DRAGGING.prehandleEvent(b);k.CANVAS_DRAGGING.mouseup(b)}k.CANVAS_DRAGGING=null});c(a).keydown(function(b){k.SHIFT=
b.shiftKey;k.ALT=b.altKey;k.META=b.metaKey;var d=k.CANVAS_OVER;if(k.CANVAS_DRAGGING!=null)d=k.CANVAS_DRAGGING;if(d!=null)if(d.keydown){d.prehandleEvent(b);d.keydown(b)}});c(a).keypress(function(b){var d=k.CANVAS_OVER;if(k.CANVAS_DRAGGING!=null)d=k.CANVAS_DRAGGING;if(d!=null)if(d.keypress){d.prehandleEvent(b);d.keypress(b)}});c(a).keyup(function(b){k.SHIFT=b.shiftKey;k.ALT=b.altKey;k.META=b.metaKey;var d=k.CANVAS_OVER;if(k.CANVAS_DRAGGING!=null)d=k.CANVAS_DRAGGING;if(d!=null)if(d.keyup){d.prehandleEvent(b);
d.keyup(b)}})});return k}(jQuery,document);
(function(c,a,k,b,d,e,l,g,h){c._Canvas=function(){this.image=this.emptyMessage=this.molecule=null;return true};c._Canvas.prototype.repaint=function(){var f=g.getElementById(this.id);if(f.getContext){var j=f.getContext("2d"),n=h.devicePixelRatio?h.devicePixelRatio:1;if(n!=1){f.width=this.width*n;f.height=this.height*n;j.scale(n,n)}if(this.image==null){if(this.specs.backgroundColor!=null){j.fillStyle=this.specs.backgroundColor;j.fillRect(0,0,this.width,this.height)}}else j.drawImage(this.image,0,0);
if(this.innerRepaint)this.innerRepaint(j);else if(this.molecule!=null&&this.molecule.atoms.length>0){j.save();j.translate(this.width/2,this.height/2);j.rotate(this.specs.rotateAngle);j.scale(this.specs.scale,this.specs.scale);j.translate(-this.width/2,-this.height/2);this.molecule.draw(j,this.specs);j.restore()}else if(this.emptyMessage!=null){j.fillStyle="#737683";j.textAlign="center";j.textBaseline="middle";j.font="18px Helvetica, Verdana, Arial, Sans-serif";j.fillText(this.emptyMessage,this.width/
2,this.height/2)}this.drawChildExtras&&this.drawChildExtras(j)}};c._Canvas.prototype.setBackgroundImage=function(f){this.image=new Image;var j=this;this.image.onload=function(){j.repaint()};this.image.src=f};c._Canvas.prototype.loadMolecule=function(f){this.molecule=f;this.center();this instanceof ChemDoodle._Canvas3D||this.molecule.check();this.afterLoadMolecule&&this.afterLoadMolecule();this.repaint()};c._Canvas.prototype.center=function(){g.getElementById(this.id);var f=this.molecule.getCenter3D(),
j=new b.Atom("C",this.width/2,this.height/2,0);j.sub3D(f);f=0;for(var n=this.molecule.atoms.length;f<n;f++)this.molecule.atoms[f].add3D(j);j=this.molecule.getDimension();this.specs.scale=1;if(j.x>this.width||j.y>this.height)this.specs.scale=l.min(this.width/j.x,this.height/j.y)*0.85};c._Canvas.prototype.create=function(f,j,n){this.id=f;this.width=j;this.height=n;if(g.getElementById(f)){var p=d("#"+f);if(j)p.attr("width",j);else this.width=p.attr("width");if(n)p.attr("height",n);else this.height=p.attr("height")}else!c.featureDetection.supports_canvas_text()&&
e.msie&&e.version>="6"?g.writeln('<div style="border: 1px solid black;" width="'+j+'" height="'+n+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>'):g.writeln('<canvas class="ChemDoodleWebComponent" id="'+f+'" width="'+j+'" height="'+n+'">This browser does not support HTML5/Canvas.</canvas>');f=d("#"+f);f.css("width",this.width);f.css("height",this.height);this.specs=new b.VisualSpecifications;var q=this;if(a.supports_touch()){f.bind("touchstart",
function(m){var t=(new Date).getTime();if(q.lastTouch&&m.originalEvent.touches.length==1&&t-q.lastTouch<500)if(q.dbltap){q.prehandleEvent(m);q.dbltap(m)}else if(q.dblclick){q.prehandleEvent(m);q.dblclick(m)}else if(q.touchstart){q.prehandleEvent(m);q.touchstart(m)}else{if(q.mousedown){q.prehandleEvent(m);q.mousedown(m)}}else if(q.touchstart){q.prehandleEvent(m);q.touchstart(m)}else if(q.mousedown){q.prehandleEvent(m);q.mousedown(m)}q.lastTouch=t});f.bind("touchmove",function(m){if(m.originalEvent.touches.length>
1&&q.multitouchmove){var t=m.originalEvent.touches.length;q.prehandleEvent(m);for(var v=new b.Point(-m.offset.left*t,-m.offset.top*t),r=0;r<t;r++){v.x+=m.originalEvent.changedTouches[r].pageX;v.y+=m.originalEvent.changedTouches[r].pageY}v.x/=t;v.y/=t;m.p=v;q.multitouchmove(m,t)}else if(q.touchmove){q.prehandleEvent(m);q.touchmove(m)}else if(q.drag){q.prehandleEvent(m);q.drag(m)}});f.bind("touchend",function(m){gestureSpread=-1;if(q.touchend){q.prehandleEvent(m);q.touchend(m)}else if(q.mouseup){q.prehandleEvent(m);
q.mouseup(m)}});f.bind("gesturestart",function(m){if(q.gesturestart){q.prehandleEvent(m);q.gesturestart(m)}});f.bind("gesturechange",function(m){if(q.gesturechange){q.prehandleEvent(m);q.gesturechange(m)}});f.bind("gestureend",function(m){if(q.gestureend){q.prehandleEvent(m);q.gestureend(m)}})}else{f.click(function(m){switch(m.which){case 1:if(q.click){q.prehandleEvent(m);q.click(m)}break;case 2:if(q.middleclick){q.prehandleEvent(m);q.middleclick(m)}break;case 3:if(q.rightclick){q.prehandleEvent(m);
q.rightclick(m)}break}});f.dblclick(function(m){if(q.dblclick){q.prehandleEvent(m);q.dblclick(m)}});f.mousedown(function(m){switch(m.which){case 1:k.CANVAS_DRAGGING=q;if(q.mousedown){q.prehandleEvent(m);q.mousedown(m)}break;case 2:if(q.middlemousedown){q.prehandleEvent(m);q.middlemousedown(m)}break;case 3:if(q.rightmousedown){q.prehandleEvent(m);q.rightmousedown(m)}break}});f.mousemove(function(m){if(k.CANVAS_DRAGGING==null&&q.mousemove){q.prehandleEvent(m);q.mousemove(m)}});f.mouseout(function(m){k.CANVAS_OVER=
null;if(q.mouseout){q.prehandleEvent(m);q.mouseout(m)}});f.mouseover(function(m){k.CANVAS_OVER=q;if(q.mouseover){q.prehandleEvent(m);q.mouseover(m)}});f.mouseup(function(m){switch(m.which){case 1:if(q.mouseup){q.prehandleEvent(m);q.mouseup(m)}break;case 2:if(q.middlemouseup){q.prehandleEvent(m);q.middlemouseup(m)}break;case 3:if(q.rightmouseup){q.prehandleEvent(m);q.rightmouseup(m)}break}});f.mousewheel(function(m,t){if(q.mousewheel){q.prehandleEvent(m);q.mousewheel(m,t)}})}this.subCreate&&this.subCreate()};
c._Canvas.prototype.getMolecule=function(){return this.molecule};c._Canvas.prototype.prehandleEvent=function(f){if(f.originalEvent.changedTouches){f.pageX=f.originalEvent.changedTouches[0].pageX;f.pageY=f.originalEvent.changedTouches[0].pageY}f.preventDefault();f.offset=d("#"+this.id).offset();f.p=new b.Point(f.pageX-f.offset.left,f.pageY-f.offset.top)}})(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document,window);
(function(c){c._AnimatorCanvas=function(a,k,b){a&&this.create(a,k,b);this.timeout=33;return true};c._AnimatorCanvas.prototype=new c._Canvas;c._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation();this.lastTime=(new Date).getTime();var a=this;if(this.nextFrame)this.handle=setInterval(function(){var k=(new Date).getTime();a.nextFrame(k-a.lastTime);a.repaint();a.lastTime=k},this.timeout)};c._AnimatorCanvas.prototype.stopAnimation=function(){if(this.handle!=null){clearInterval(this.handle);
this.handle=null}};c._AnimatorCanvas.prototype.isRunning=function(){return this.handle!=null}})(ChemDoodle);
(function(c,a){c.FileCanvas=function(k,b,d,e){k&&this.create(k,b,d);form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+e+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+k+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+k+"', "+k+')"></iframe>';a.writeln(form);this.emptyMessage="Click below to load file";this.repaint();
return true};c.FileCanvas.prototype=new c._Canvas})(ChemDoodle,document);
(function(c){c.HyperlinkCanvas=function(a,k,b,d,e,l){a&&this.create(a,k,b);this.urlOrFunction=d;this.color=e?e:"blue";this.size=l?l:2;this.openInNewWindow=true;this.e=this.hoverImage=null;return true};c.HyperlinkCanvas.prototype=new c._Canvas;c.HyperlinkCanvas.prototype.drawChildExtras=function(a){if(this.e!=null)if(this.hoverImage==null){a.strokeStyle=this.color;a.lineWidth=this.size*2;a.strokeRect(0,0,this.width,this.height)}else a.drawImage(this.hoverImage,0,0)};c.HyperlinkCanvas.prototype.setHoverImage=
function(a){this.hoverImage=new Image;this.hoverImage.src=a};c.HyperlinkCanvas.prototype.click=function(){this.e=null;this.repaint();if(this.urlOrFunction instanceof Function)this.urlOrFunction();else if(this.openInNewWindow)window.open(this.urlOrFunction);else location.href=this.urlOrFunction};c.HyperlinkCanvas.prototype.mouseout=function(){this.e=null;this.repaint()};c.HyperlinkCanvas.prototype.mouseover=function(a){this.e=a;this.repaint()}})(ChemDoodle);
(function(c,a,k,b){c.MolGrabberCanvas=function(d,e,l){d&&this.create(d,e,l);e=[];e.push('<br><input type="text" id="');e.push(d);e.push('_query" size="32" value="" />');e.push("<br><nobr>");e.push('<select id="');e.push(d);e.push('_select">');e.push('<option value="chemexper">ChemExper');e.push('<option value="chemspider">ChemSpider');e.push('<option value="pubchem" selected>PubChem');e.push("</select>");e.push('<button id="');e.push(d);e.push('_submit">Show Molecule</button>');e.push("</nobr>");
b.writeln(e.join(""));var g=this;k("#"+d+"_submit").click(function(){g.search()});k("#"+d+"_query").keypress(function(h){h.which==13&&g.search()});this.emptyMessage="Enter search term below";this.repaint();return true};c.MolGrabberCanvas.prototype=new c._Canvas;c.MolGrabberCanvas.prototype.setSearchTerm=function(d){k("#"+this.id+"_query").val(d);this.search()};c.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...";this.molecule=null;this.repaint();var d=this;a.getMoleculeFromDatabase(k("#"+
this.id+"_select").val(),k("#"+this.id+"_query").val(),function(e){d.loadMolecule(e)})}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,a,k){c.RotatorCanvas=function(b,d,e,l){b&&this.create(b,d,e);this.rotate3D=l;this.zIncrement=this.yIncrement=this.xIncrement=b=a.PI/15;return true};c.RotatorCanvas.prototype=new c._AnimatorCanvas;c.RotatorCanvas.prototype.nextFrame=function(b){if(this.molecule==null)this.stopAnimation();else{var d=b/1E3;if(this.rotate3D){b=[];k.identity(b);k.rotate(b,this.xIncrement*d,[1,0,0]);k.rotate(b,this.yIncrement*d,[0,1,0]);k.rotate(b,this.zIncrement*d,[0,0,1]);d=0;for(var e=this.molecule.atoms.length;d<
e;d++){var l=this.molecule.atoms[d],g=[l.x-this.width/2,l.y-this.height/2,l.z];k.multiplyVec3(b,g);l.x=g[0]+this.width/2;l.y=g[1]+this.height/2;l.z=g[2]}d=0;for(e=this.molecule.rings.length;d<e;d++)this.molecule.rings[d].center=this.molecule.rings[d].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*d}};c.RotatorCanvas.prototype.dblclick=
function(){this.isRunning()?this.stopAnimation():this.startAnimation()}})(ChemDoodle,Math,mat4);
(function(c){c.SlideshowCanvas=function(a,k,b){a&&this.create(a,k,b);this.molecules=[];this.curIndex=0;this.timeout=5E3;this.alpha=0;this.innerHandle=null;this.phase=0;return true};c.SlideshowCanvas.prototype=new c._AnimatorCanvas;c.SlideshowCanvas.prototype.drawChildExtras=function(a){a.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")";
a.fillRect(0,0,this.width,this.height)};c.SlideshowCanvas.prototype.nextFrame=function(){if(this.molecules.length==0)this.stopAnimation();else{this.phase=0;var a=this,k=1;this.innerHandle=setInterval(function(){a.alpha=k/15;a.repaint();k==15&&a.breakInnerHandle();k++},33)}};c.SlideshowCanvas.prototype.breakInnerHandle=function(){if(this.innerHandle!=null){clearInterval(this.innerHandle);this.innerHandle=null}if(this.phase==0){this.curIndex++;if(this.curIndex>this.molecules.length-1)this.curIndex=
0;this.alpha=1;this.loadMolecule(this.molecules[this.curIndex]);this.phase=1;var a=this,k=1;this.innerHandle=setInterval(function(){a.alpha=(15-k)/15;a.repaint();k==15&&a.breakInnerHandle();k++},33)}else if(this.phase==1){this.alpha=0;this.repaint()}};c.SlideshowCanvas.prototype.addMolecule=function(a){this.molecules.length==0&&this.loadMolecule(a);this.molecules.push(a)}})(ChemDoodle);
(function(c,a,k,b,d){c.TransformCanvas=function(e,l,g,h){e&&this.create(e,l,g);this.lastPoint=null;this.rotate3D=h;this.rotationMultMod=1.3;this.lastPinchScale=1;this.lastGestureRotate=0;return true};c.TransformCanvas.prototype=new c._Canvas;c.TransformCanvas.prototype.mousedown=function(e){this.lastPoint=e.p};c.TransformCanvas.prototype.dblclick=function(){var e=new k.Point(this.width/2,this.height/2);e.sub(this.molecule.getCenter());for(var l=0,g=this.molecule.atoms.length;l<g;l++)this.molecule.atoms[l].add(e);
this.molecule.check();this.repaint()};c.TransformCanvas.prototype.drag=function(e){if(!this.lastPoint.multi){if(a.ALT){var l=new k.Point(e.p.x,e.p.y);l.sub(this.lastPoint);for(var g=0,h=this.molecule.atoms.length;g<h;g++)this.molecule.atoms[g].add(l);this.lastPoint=e.p;this.molecule.check()}else if(this.rotate3D==true){l=b.max(this.width/4,this.height/4);g=(e.p.x-this.lastPoint.x)/l*this.rotationMultMod;h=-(e.p.y-this.lastPoint.y)/l*this.rotationMultMod;l=[];d.identity(l);d.rotate(l,h,[1,0,0]);d.rotate(l,
g,[0,1,0]);g=0;for(h=this.molecule.atoms.length;g<h;g++){var f=this.molecule.atoms[g],j=[f.x-this.width/2,f.y-this.height/2,f.z];d.multiplyVec3(l,j);f.x=j[0]+this.width/2;f.y=j[1]+this.height/2;f.z=j[2]}g=0;for(h=this.molecule.rings.length;g<h;g++)this.molecule.rings[g].center=this.molecule.rings[g].getCenter();this.lastPoint=e.p;this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ();this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else{l=
new k.Point(this.width/2,this.height/2);g=l.angle(this.lastPoint);this.specs.rotateAngle-=l.angle(e.p)-g;this.lastPoint=e.p}this.repaint()}};c.TransformCanvas.prototype.mousewheel=function(e,l){this.specs.scale+=l/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};c.TransformCanvas.prototype.multitouchmove=function(e,l){if(l==2)if(this.lastPoint.multi){var g=new k.Point(e.p.x,e.p.y);g.sub(this.lastPoint);for(var h=0,f=this.molecule.atoms.length;h<f;h++)this.molecule.atoms[h].add(g);
this.lastPoint=e.p;this.lastPoint.multi=true;this.molecule.check();this.repaint()}else{this.lastPoint=e.p;this.lastPoint.multi=true}};c.TransformCanvas.prototype.gesturechange=function(e){if(e.originalEvent.scale-this.lastPinchScale!=0){this.specs.scale*=e.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=e.originalEvent.scale}if(this.lastGestureRotate-e.originalEvent.rotation!=0){for(var l=(this.lastGestureRotate-e.originalEvent.rotation)/
180*b.PI,g=new k.Point(this.width/2,this.height/2),h=0,f=this.molecule.atoms.length;h<f;h++){var j=g.distance(this.molecule.atoms[h]),n=g.angle(this.molecule.atoms[h])+l;this.molecule.atoms[h].x=g.x+j*b.cos(n);this.molecule.atoms[h].y=g.y-j*b.sin(n)}this.lastGestureRotate=e.originalEvent.rotation;this.molecule.check()}this.repaint()};c.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1;this.lastGestureRotate=0}})(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4);
(function(c){c.ViewerCanvas=function(a,k,b){a&&this.create(a,k,b);return true};c.ViewerCanvas.prototype=new c._Canvas})(ChemDoodle);
(function(c){c._SpectrumCanvas=function(a,k,b){a&&this.create(a,k,b);this.spectrum=null;this.emptyMessage="No Spectrum Loaded or Recognized";this.getMolecule=this.loadMolecule=null;return true};c._SpectrumCanvas.prototype=new c._Canvas;c._SpectrumCanvas.prototype.innerRepaint=function(a){if(this.spectrum!=null&&this.spectrum.data.length>0)this.spectrum.draw(a,this.specs,this.width,this.height);else if(this.emptyMessage!=null){a.fillStyle="#737683";a.textAlign="center";a.textBaseline="middle";a.font=
"18px Helvetica, Verdana, Arial, Sans-serif";a.fillText(this.emptyMessage,this.width/2,this.height/2)}};c._SpectrumCanvas.prototype.loadSpectrum=function(a){this.spectrum=a;this.repaint()};c._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum}})(ChemDoodle,document);(function(c){c.ObserverCanvas=function(a,k,b){a&&this.create(a,k,b);return true};c.ObserverCanvas.prototype=new c._SpectrumCanvas})(ChemDoodle);
(function(c,a,k){c.PerspectiveCanvas=function(b,d,e){b&&this.create(b,d,e);this.dragRange=null;this.rescaleYAxisOnZoom=true;this.lastPinchScale=1;return true};c.PerspectiveCanvas.prototype=new c._SpectrumCanvas;c.PerspectiveCanvas.prototype.mousedown=function(b){this.dragRange=new c.structures.Point(b.p.x,b.p.x)};c.PerspectiveCanvas.prototype.mouseup=function(b){if(this.dragRange!=null&&this.dragRange.x!=this.dragRange.y){if(!this.dragRange.multi){b=this.spectrum.zoom(this.dragRange.x,b.p.x,this.width,
this.rescaleYAxisOnZoom);if(this.rescaleYAxisOnZoom)this.specs.scale=b}this.dragRange=null;this.repaint()}};c.PerspectiveCanvas.prototype.drag=function(b){if(this.dragRange!=null){if(this.dragRange.multi)this.dragRange=null;else{if(a.SHIFT){this.spectrum.translate(b.p.x-this.dragRange.x,this.width);this.dragRange.x=b.p.x}this.dragRange.y=b.p.x}this.repaint()}};c.PerspectiveCanvas.prototype.drawChildExtras=function(b){if(this.dragRange!=null){var d=k.min(this.dragRange.x,this.dragRange.y),e=k.max(this.dragRange.x,
this.dragRange.y);b.strokeStyle="gray";b.lineStyle=1;b.beginPath();b.moveTo(d,this.height/2);for(d=d;d<=e;d++)d%10<5?b.lineTo(d,k.round(this.height/2)):b.moveTo(d,k.round(this.height/2));b.stroke()}};c.PerspectiveCanvas.prototype.mousewheel=function(b,d){this.specs.scale+=d/10;if(this.specs.scale<0.01)this.specs.scale=0.01;this.repaint()};c.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup();this.specs.scale=1;this.repaint()};c.PerspectiveCanvas.prototype.multitouchmove=function(b,
d){if(d==2)if(this.dragRange==null||!this.dragRange.multi){this.dragRange=new c.structures.Point(b.p.x,b.p.x);this.dragRange.multi=true}else{this.spectrum.translate(b.p.x-this.dragRange.x,this.width);this.dragRange.x=b.p.x;this.dragRange.y=b.p.x;this.repaint()}};c.PerspectiveCanvas.prototype.gesturechange=function(b){this.specs.scale*=b.originalEvent.scale/this.lastPinchScale;if(this.specs.scale<0.01)this.specs.scale=0.01;this.lastPinchScale=b.originalEvent.scale;this.repaint()};c.PerspectiveCanvas.prototype.gestureend=
function(){this.lastPinchScale=1}})(ChemDoodle,ChemDoodle.monitor,Math);
(function(c,a,k,b,d,e,l,g,h,f){c._Canvas3D=function(j,n,p){j&&this.create(j,n,p);this.rotationMatrix=g.identity([]);this.translationMatrix=g.identity([]);this.lastPoint=null;this.emptyMessage="WebGL is Unavailable!";return true};c._Canvas3D.prototype=new c._Canvas;c._Canvas3D.prototype.afterLoadMolecule=function(){var j=this.molecule.getDimension();this.translationMatrix=g.translate(g.identity([]),[0,0,-e.max(j.x,j.y)-10]);this.setupScene()};c._Canvas3D.prototype.setViewDistance=function(j){this.translationMatrix=
g.translate(g.identity([]),[0,0,-j])};c._Canvas3D.prototype.repaint=function(){if(this.gl){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);this.gl.modelViewMatrix=g.multiply(this.translationMatrix,this.rotationMatrix,[]);this.gl.rotationMatrix=this.rotationMatrix;this.molecule!=null&&this.molecule.render(this.gl,this.specs);this.gl.flush()}};c._Canvas3D.prototype.center=function(){l.getElementById(this.id);for(var j=this.molecule.getCenter3D(),n=0,p=this.molecule.atoms.length;n<p;n++)this.molecule.atoms[n].sub3D(j);
if(this.molecule.chains&&this.molecule.fromJSON){n=0;for(p=this.molecule.chains.length;n<p;n++)for(var q=this.molecule.chains[n],m=0,t=q.length;m<t;m++){var v=q[m];v.cp1.sub3D(j);v.cp2.sub3D(j);if(v.cp3){v.cp3.sub3D(j);v.cp4.sub3D(j);v.cp5.sub3D(j)}}}};c._Canvas3D.prototype.subCreate=function(){try{this.gl=l.getElementById(this.id).getContext("webgl");if(!this.gl)this.gl=l.getElementById(this.id).getContext("experimental-webgl")}catch(j){}if(this.gl){this.gl.viewport(0,0,this.width,this.height);this.gl.program=
this.gl.createProgram();this.gl.shader=new b.Shader;this.gl.shader.init(this.gl);this.setupScene()}else{this.molecule=null;this.displayMessage()}};c._Canvas.prototype.displayMessage=function(){var j=l.getElementById(this.id);if(j.getContext){j=j.getContext("2d");if(this.specs.backgroundColor!=null){j.fillStyle=this.specs.backgroundColor;j.fillRect(0,0,this.width,this.height)}if(this.emptyMessage!=null){j.fillStyle="#737683";j.textAlign="center";j.textBaseline="middle";j.font="18px Helvetica, Verdana, Arial, Sans-serif";
j.fillText(this.emptyMessage,this.width/2,this.height/2)}}};c._Canvas3D.prototype.setupScene=function(){if(this.gl){var j=k.getRGB(this.specs.backgroundColor,1);this.gl.clearColor(j[0],j[1],j[2],1);this.gl.clearDepth(1);this.gl.enable(this.gl.DEPTH_TEST);this.gl.depthFunc(this.gl.LEQUAL);this.gl.sphereBuffer=new b.Sphere(this.gl,1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D);this.gl.cylinderBuffer=new b.Cylinder(this.gl,1,1,this.specs.bonds_resolution_3D);if(this.molecule){if(this.molecule.unitCellVectors)this.molecule.unitCell=
new b.UnitCell(this.gl,this.molecule.unitCellVectors);if(this.molecule.chains){this.molecule.ribbons=[];this.molecule.cartoons=[];this.molecule.tubes=[];j=0;for(var n=this.molecule.chains.length;j<n;j++){var p=this.molecule.chains[j],q=p.length>2&&d[p[2].name]&&d[p[2].name].aminoColor=="#BEA06E";if(p.length>0&&!p[0].lineSegments){for(var m=0,t=p.length-1;m<t;m++){if(q)p[m].Ns=1;p[m].setup(p[m+1].cp1)}if(!q){m=1;for(t=p.length-1;m<t;m++)if(a.vec3AngleFrom(p[m-1].D,p[m].D)>e.PI/2){p[m].guidePointsSmall.reverse();
p[m].guidePointsLarge.reverse();f.scale(p[m].D,-1)}}m=1;for(t=p.length-3;m<t;m++)p[m].computeLineSegments(p[m-1],p[m+1],p[m+2],!q);p.pop();p.pop();p.pop();p.shift()}if(q)this.molecule.tubes.push(new b.Tube(this.gl,p,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D));else{this.molecule.ribbons.push({front:new b.Ribbon(this.gl,p,this.specs.proteins_ribbonThickness,false),back:new b.Ribbon(this.gl,p,-this.specs.proteins_ribbonThickness,false)});this.molecule.cartoons.push({front:new b.Ribbon(this.gl,
p,this.specs.proteins_ribbonThickness,true),back:new b.Ribbon(this.gl,p,-this.specs.proteins_ribbonThickness,true)})}}}}this.gl.lighting=new b.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D);this.gl.lighting.lightScene(this.gl);this.gl.material=new b.Material(this.gl);this.gl.projectionMatrix=this.specs.projectionPerspective_3D?g.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,this.specs.projectionWidthHeightRatio_3D,this.specs.projectionFrontCulling_3D,
this.specs.projectionBackCulling_3D):g.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/this.specs.projectionWidthHeightRatio_3D,this.specs.projectionOrthoWidth_3D/2/this.specs.projectionWidthHeightRatio_3D,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),false,this.gl.projectionMatrix);var v=this.gl.getUniformLocation(this.gl.program,
"u_model_view_matrix"),r=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(w){this.uniformMatrix4fv(v,false,w);w=h.transpose(g.toInverseMat3(w,[]));this.uniformMatrix3fv(r,false,w)}}};c._Canvas3D.prototype.mousedown=function(j){this.lastPoint=j.p};c._Canvas3D.prototype.rightmousedown=function(j){this.lastPoint=j.p};c._Canvas3D.prototype.drag=function(j){if(c.monitor.ALT){var n=new b.Point(j.p.x,j.p.y);n.sub(this.lastPoint);g.translate(this.translationMatrix,
[n.x/20,-n.y/20,0])}else{e.max(this.width/4,this.height/4);var p=j.p.x-this.lastPoint.x;n=j.p.y-this.lastPoint.y;p=g.rotate(g.identity([]),p*e.PI/180,[0,1,0]);g.rotate(p,n*e.PI/180,[1,0,0]);this.rotationMatrix=g.multiply(p,this.rotationMatrix)}this.lastPoint=j.p;this.repaint()};c._Canvas3D.prototype.mousewheel=function(j,n){g.translate(this.translationMatrix,[0,0,n*2]);this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math,document,mat4,mat3,
vec3);
(function(c,a,k,b){c.MolGrabberCanvas3D=function(d,e,l){d&&this.create(d,e,l);e=[];e.push('<br><input type="text" id="');e.push(d);e.push('_query" size="32" value="" />');e.push("<br><nobr>");e.push('<select id="');e.push(d);e.push('_select">');e.push('<option value="pubchem" selected>PubChem');e.push("</select>");e.push('<button id="');e.push(d);e.push('_submit">Show Molecule</button>');e.push("</nobr>");b.writeln(e.join(""));var g=this;k("#"+d+"_submit").click(function(){g.search()});k("#"+d+"_query").keypress(function(h){h.which==
13&&g.search()});return true};c.MolGrabberCanvas3D.prototype=new c._Canvas3D;c.MolGrabberCanvas3D.prototype.setSearchTerm=function(d){k("#"+this.id+"_query").val(d);this.search()};c.MolGrabberCanvas3D.prototype.search=function(){var d=this;a.getMoleculeFromDatabase(k("#"+this.id+"_select").val(),k("#"+this.id+"_query").val(),function(e){d.loadMolecule(e)},3)}})(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document);
(function(c,a,k){c.RotatorCanvas3D=function(b,d,e){b&&this.create(b,d,e);this.timeout=33;this.zIncrement=this.yIncrement=this.xIncrement=b=a.PI/15;return true};c.RotatorCanvas3D.prototype=new c._Canvas3D;c.RotatorCanvas3D.prototype.startAnimation=c._AnimatorCanvas.prototype.startAnimation;c.RotatorCanvas3D.prototype.stopAnimation=c._AnimatorCanvas.prototype.stopAnimation;c.RotatorCanvas3D.prototype.isRunning=c._AnimatorCanvas.prototype.isRunning;c.RotatorCanvas3D.prototype.dblclick=c.RotatorCanvas.prototype.dblclick;
c.RotatorCanvas3D.prototype.mousedown=null;c.RotatorCanvas3D.prototype.rightmousedown=null;c.RotatorCanvas3D.prototype.drag=null;c.RotatorCanvas3D.prototype.mousewheel=null;c.RotatorCanvas3D.prototype.nextFrame=function(b){if(this.molecule==null)this.stopAnimation();else{var d=[];k.identity(d);b=b/1E3;k.rotate(d,this.xIncrement*b,[1,0,0]);k.rotate(d,this.yIncrement*b,[0,1,0]);k.rotate(d,this.zIncrement*b,[0,0,1]);k.multiply(this.rotationMatrix,d)}}})(ChemDoodle,Math,mat4);
(function(c){c.TransformCanvas3D=function(a,k,b){a&&this.create(a,k,b);return true};c.TransformCanvas3D.prototype=new c._Canvas3D})(ChemDoodle);(function(c){c.ViewerCanvas3D=function(a,k,b){a&&this.create(a,k,b);return true};c.ViewerCanvas3D.prototype=new c._Canvas3D;c.ViewerCanvas3D.prototype.mousedown=null;c.ViewerCanvas3D.prototype.rightmousedown=null;c.ViewerCanvas3D.prototype.drag=null;c.ViewerCanvas3D.prototype.mousewheel=null})(ChemDoodle);
(function(c,a,k){function b(d,e,l,g){this.element=d;this.x=e;this.y=l;this.dimension=g}c.PeriodicTableCanvas=function(d,e){this.padding=5;d&&this.create(d,e*18+this.padding*2,e*10+this.padding*2);this.getMolecule=this.loadMolecule=null;this.cellDimension=e?e:20;this.setupTable();this.repaint();return true};c.PeriodicTableCanvas.prototype=new c._Canvas;c.PeriodicTableCanvas.prototype.getHoveredElement=function(){if(this.hovered!=null)return this.hovered.element;return null};c.PeriodicTableCanvas.prototype.innerRepaint=
function(d){for(var e=0,l=this.cells.length;e<l;e++)this.drawCell(d,this.specs,this.cells[e]);this.hovered!=null&&this.drawCell(d,this.specs,this.hovered);this.selected!=null&&this.drawCell(d,this.specs,this.selected)};c.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var d=y=this.padding,e=0,l=0,g=c.SYMBOLS.length;l<g;l++){if(e==18){e=0;y+=this.cellDimension;d=this.padding}var h=c.ELEMENT[c.SYMBOLS[l]];if(h.atomicNumber==2){d+=16*this.cellDimension;e+=16}else if(h.atomicNumber==
5||h.atomicNumber==13){d+=10*this.cellDimension;e+=10}if((h.atomicNumber<58||h.atomicNumber>71&&h.atomicNumber<90||h.atomicNumber>103)&&h.atomicNumber<113){this.cells.push(new b(h,d,y,this.cellDimension));d+=this.cellDimension;e++}}y+=2*this.cellDimension;d=3*this.cellDimension+this.padding;for(l=57;l<104;l++){h=c.ELEMENT[c.SYMBOLS[l]];if(h.atomicNumber==90){y+=this.cellDimension;d=3*this.cellDimension+this.padding}if(h.atomicNumber>=58&&h.atomicNumber<=71||h.atomicNumber>=90&&h.atomicNumber<=103){this.cells.push(new b(h,
d,y,this.cellDimension));d+=this.cellDimension}}};c.PeriodicTableCanvas.prototype.drawCell=function(d,e,l){var g=d.createRadialGradient(l.x+l.dimension/3,l.y+l.dimension/3,l.dimension*1.5,l.x+l.dimension/3,l.y+l.dimension/3,l.dimension/10);g.addColorStop(0,"#000000");g.addColorStop(0.7,l.element.jmolColor);g.addColorStop(1,"#FFFFFF");d.fillStyle=g;a.contextRoundRect(d,l.x,l.y,l.dimension,l.dimension,l.dimension/8);if(l==this.hovered||l==this.selected){d.lineWidth=2;d.strokeStyle="#c10000";d.stroke();
d.fillStyle="white"}d.fill();d.font=e.getFontString(e.text_font_size,e.text_font_families);d.fillStyle=e.text_color;d.textAlign="center";d.textBaseline="middle";d.fillText(l.element.symbol,l.x+l.dimension/2,l.y+l.dimension/2)};c.PeriodicTableCanvas.prototype.click=function(){if(this.hovered!=null){this.selected=this.hovered;this.repaint()}};c.PeriodicTableCanvas.prototype.mousemove=function(d){var e=d.p.x;d=d.p.y;this.hovered=null;for(var l=0,g=this.cells.length;l<g;l++){var h=this.cells[l];if(k.isBetween(e,
h.x,h.x+h.dimension)&&k.isBetween(d,h.y,h.y+h.dimension)){this.hovered=h;break}}this.repaint()};c.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null;this.repaint()}})(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document);(function(c,a){c._Layout=function(){return true};c._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()};c._Layout.prototype.create=function(k){this.name=k;this.specs=new a.VisualSpecifications}})(ChemDoodle,ChemDoodle.structures);
(function(c,a,k){c.SimpleReactionLayout=function(b){this.reactants=[];this.products=[];this.textBelow=this.textAbove=null;this.arrow="&rarr;";this.plus="+";this.create(b);return true};c.SimpleReactionLayout.prototype=new c._Layout;c.SimpleReactionLayout.prototype.addReactant=function(b){this.reactants.push(b)};c.SimpleReactionLayout.prototype.addProduct=function(b){this.products.push(b)};c.SimpleReactionLayout.prototype.innerLayout=function(){k.writeln("<table><tr>");for(var b=0,d=this.reactants.length;b<
d;b++){b>0&&k.writeln('<td><span style="font-size:25px;">'+this.plus+"</span></td>");k.writeln("<td>");var e=this.reactants[b].getDimension();e=new c.ViewerCanvas(this.name+"_reactant"+b,e.x+60,e.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_reactant"+b).css("border","0px");e.specs=this.specs;e.loadMolecule(this.reactants[b]);k.writeln("</td>")}k.writeln("<td>");k.writeln("<table>");k.writeln("<tr><td>");this.textAbove!=null?k.writeln("<center>"+this.textAbove+"</center>"):k.writeln("&nbsp;");
k.writeln("</td></tr>");k.writeln('<tr><td><center><span style="font-size:25px;">'+this.arrow+"</span></center></td></tr>");k.writeln("<tr><td>");this.textBelow!=null?k.writeln("<center>"+this.textBelow+"</center>"):k.writeln("&nbsp;");k.writeln("</td></tr>");k.writeln("</table>");k.writeln("</td>");b=0;for(d=this.products.length;b<d;b++){b>0&&k.writeln('<td><span style="font-size:25px;">'+this.plus+"</td>");k.writeln("<td>");e=this.products[b].getDimension();e=new c.ViewerCanvas(this.name+"_product"+
b,e.x+60,e.y+60);this.specs.backgroundColor==null&&a("#"+this.name+"_product"+b).css("border","0px");e.specs=this.specs;e.loadMolecule(this.products[b]);k.writeln("</td>")}k.writeln("</tr></table>")}})(ChemDoodle,jQuery,document);(function(c,a,k){c.png={};c.png.create=function(b){k.open(a.getElementById(b.id).toDataURL("image/png"))}})(ChemDoodle.io,document,window);
